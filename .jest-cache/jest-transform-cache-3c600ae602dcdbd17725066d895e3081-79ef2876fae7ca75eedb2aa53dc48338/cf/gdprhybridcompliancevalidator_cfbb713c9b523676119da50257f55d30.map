{"file":"/Users/matbakh-visibility-boost.20250920/src/lib/ai-orchestrator/gdpr-hybrid-compliance-validator.ts","mappings":"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","names":[],"sources":["/Users/matbakh-visibility-boost.20250920/src/lib/ai-orchestrator/gdpr-hybrid-compliance-validator.ts"],"sourcesContent":["/**\n * GDPR Hybrid Compliance Validator\n *\n * Validates GDPR compliance for both direct Bedrock and MCP routing paths\n * in the Bedrock Support Manager hybrid architecture.\n */\n\nimport { GDPRComplianceValidator } from \"../compliance/gdpr-compliance-validator\";\nimport { AuditTrailSystem } from \"./audit-trail-system\";\nimport { BasicLogger } from \"./basic-logger\";\nimport { ComplianceIntegration } from \"./compliance-integration\";\nimport { ProviderAgreementCompliance } from \"./provider-agreement-compliance\";\nimport { Provider } from \"./types\";\n\nexport interface HybridRoutingPath {\n  routeType: \"direct_bedrock\" | \"mcp_integration\";\n  provider: Provider;\n  operationType:\n    | \"emergency\"\n    | \"infrastructure\"\n    | \"meta_monitor\"\n    | \"implementation\"\n    | \"kiro_communication\"\n    | \"standard_analysis\"\n    | \"background_tasks\";\n  priority: \"critical\" | \"high\" | \"medium\" | \"low\";\n}\n\nexport interface GDPRComplianceValidation {\n  routingPath: HybridRoutingPath;\n  isCompliant: boolean;\n  complianceScore: number;\n  violations: GDPRViolation[];\n  warnings: GDPRWarning[];\n  dataProcessingCompliance: DataProcessingCompliance;\n  auditTrailCompliance: AuditTrailCompliance;\n  timestamp: Date;\n  correlationId: string;\n}\n\nexport interface GDPRViolation {\n  id: string;\n  severity: \"low\" | \"medium\" | \"high\" | \"critical\";\n  category:\n    | \"data_processing\"\n    | \"data_storage\"\n    | \"user_rights\"\n    | \"consent\"\n    | \"security\"\n    | \"ai_operations\";\n  description: string;\n  routingPath: \"direct_bedrock\" | \"mcp_integration\" | \"both\";\n  remediation: string;\n  gdprArticle: string;\n}\n\nexport interface GDPRWarning {\n  id: string;\n  category:\n    | \"data_processing\"\n    | \"data_storage\"\n    | \"user_rights\"\n    | \"consent\"\n    | \"security\"\n    | \"ai_operations\";\n  description: string;\n  routingPath: \"direct_bedrock\" | \"mcp_integration\" | \"both\";\n  recommendation: string;\n}\n\nexport interface DataProcessingCompliance {\n  lawfulBasisDocumented: boolean;\n  purposeLimitationEnforced: boolean;\n  dataMinimizationImplemented: boolean;\n  consentManagementActive: boolean;\n  piiDetectionEnabled: boolean;\n  dataRetentionPoliciesActive: boolean;\n  euDataResidencyCompliant: boolean;\n}\n\nexport interface AuditTrailCompliance {\n  auditLoggingEnabled: boolean;\n  correlationIdTracking: boolean;\n  routingPathLogged: boolean;\n  complianceChecksLogged: boolean;\n  dataProcessingActivitiesLogged: boolean;\n  retentionPolicyCompliant: boolean;\n  integrityCheckingEnabled: boolean;\n}\n\nexport interface HybridComplianceReport {\n  timestamp: Date;\n  overallCompliance: \"compliant\" | \"non_compliant\" | \"partial\";\n  complianceScore: number;\n  routingPathCompliance: {\n    directBedrock: GDPRComplianceValidation;\n    mcpIntegration: GDPRComplianceValidation;\n  };\n  crossPathCompliance: {\n    dataConsistency: boolean;\n    auditTrailContinuity: boolean;\n    consentPropagation: boolean;\n    piiHandlingConsistency: boolean;\n  };\n  recommendations: string[];\n  criticalIssues: string[];\n  nextActions: Array<{\n    action: string;\n    priority: \"low\" | \"medium\" | \"high\" | \"critical\";\n    dueDate: Date;\n    routingPath: \"direct_bedrock\" | \"mcp_integration\" | \"both\";\n  }>;\n}\n\n/**\n * GDPR Hybrid Compliance Validator\n */\nexport class GDPRHybridComplianceValidator {\n  private logger: BasicLogger;\n  private auditTrail: AuditTrailSystem;\n  private gdprValidator: GDPRComplianceValidator;\n  private complianceIntegration: ComplianceIntegration;\n  private providerCompliance: ProviderAgreementCompliance;\n\n  constructor() {\n    this.logger = new BasicLogger(\"gdpr-hybrid-compliance-validator\");\n    this.auditTrail = new AuditTrailSystem({\n      complianceMode: \"strict\",\n      enableIntegrityChecking: true,\n      retentionDays: 2555, // 7 years for GDPR compliance\n    });\n    this.gdprValidator = new GDPRComplianceValidator();\n    this.complianceIntegration = new ComplianceIntegration();\n    this.providerCompliance = new ProviderAgreementCompliance();\n  }\n\n  /**\n   * Validate GDPR compliance for a specific routing path\n   */\n  async validateRoutingPathCompliance(\n    routingPath: HybridRoutingPath,\n    correlationId: string\n  ): Promise<GDPRComplianceValidation> {\n    const startTime = Date.now();\n    const timestamp = new Date();\n\n    try {\n      this.logger.info(\"Starting GDPR compliance validation\", {\n        routingPath: routingPath.routeType,\n        provider: routingPath.provider,\n        operationType: routingPath.operationType,\n        correlationId,\n      });\n\n      // Validate provider agreement compliance\n      const providerCompliance =\n        await this.providerCompliance.verifyProviderCompliance(\n          routingPath.provider\n        );\n\n      // Check for invalid provider\n      if (routingPath.provider === \"invalid\" || !providerCompliance.agreement) {\n        throw new Error(\n          `Invalid or unsupported provider: ${routingPath.provider}`\n        );\n      }\n\n      // Validate data processing compliance\n      const dataProcessingCompliance =\n        await this.validateDataProcessingCompliance(routingPath);\n\n      // Validate audit trail compliance\n      const auditTrailCompliance = await this.validateAuditTrailCompliance(\n        routingPath\n      );\n\n      // Check routing-specific GDPR requirements\n      const routingSpecificChecks = await this.performRoutingSpecificGDPRChecks(\n        routingPath\n      );\n\n      // Collect violations and warnings\n      const violations: GDPRViolation[] = [];\n      const warnings: GDPRWarning[] = [];\n\n      // Provider agreement violations\n      if (!providerCompliance.compliant) {\n        providerCompliance.violations.forEach((violation, index) => {\n          violations.push({\n            id: `provider-${index}`,\n            severity: \"high\",\n            category: \"ai_operations\",\n            description: violation,\n            routingPath: routingPath.routeType,\n            remediation:\n              \"Update provider agreement or switch to compliant provider\",\n            gdprArticle: \"Article 28 - Processor\",\n          });\n        });\n      }\n\n      // Data processing violations\n      if (!dataProcessingCompliance.lawfulBasisDocumented) {\n        violations.push({\n          id: \"lawful-basis\",\n          severity: \"critical\",\n          category: \"data_processing\",\n          description: \"No documented lawful basis for data processing\",\n          routingPath: routingPath.routeType,\n          remediation: \"Document lawful basis under GDPR Article 6\",\n          gdprArticle: \"Article 6 - Lawfulness of processing\",\n        });\n      }\n\n      if (!dataProcessingCompliance.purposeLimitationEnforced) {\n        violations.push({\n          id: \"purpose-limitation\",\n          severity: \"high\",\n          category: \"data_processing\",\n          description: \"Purpose limitation not enforced in routing path\",\n          routingPath: routingPath.routeType,\n          remediation: \"Implement purpose limitation controls\",\n          gdprArticle: \"Article 5(1)(b) - Purpose limitation\",\n        });\n      }\n\n      if (!dataProcessingCompliance.dataMinimizationImplemented) {\n        violations.push({\n          id: \"data-minimization\",\n          severity: \"high\",\n          category: \"data_processing\",\n          description: \"Data minimization not implemented\",\n          routingPath: routingPath.routeType,\n          remediation: \"Implement PII detection and data minimization\",\n          gdprArticle: \"Article 5(1)(c) - Data minimisation\",\n        });\n      }\n\n      if (!dataProcessingCompliance.euDataResidencyCompliant) {\n        violations.push({\n          id: \"eu-residency\",\n          severity: \"critical\",\n          category: \"data_storage\",\n          description: \"EU data residency requirements not met\",\n          routingPath: routingPath.routeType,\n          remediation: \"Ensure all data processing occurs within EU regions\",\n          gdprArticle:\n            \"Article 44-49 - Transfers of personal data to third countries\",\n        });\n      }\n\n      // Audit trail violations\n      if (!auditTrailCompliance.auditLoggingEnabled) {\n        violations.push({\n          id: \"audit-logging\",\n          severity: \"high\",\n          category: \"security\",\n          description: \"Audit logging not enabled for routing path\",\n          routingPath: routingPath.routeType,\n          remediation: \"Enable comprehensive audit logging\",\n          gdprArticle: \"Article 30 - Records of processing activities\",\n        });\n      }\n\n      if (!auditTrailCompliance.routingPathLogged) {\n        violations.push({\n          id: \"routing-audit\",\n          severity: \"medium\",\n          category: \"security\",\n          description: \"Routing path decisions not logged in audit trail\",\n          routingPath: routingPath.routeType,\n          remediation: \"Log all routing decisions with correlation IDs\",\n          gdprArticle: \"Article 30 - Records of processing activities\",\n        });\n      }\n\n      // Add warnings for non-critical issues\n      if (!dataProcessingCompliance.piiDetectionEnabled) {\n        warnings.push({\n          id: \"pii-detection\",\n          category: \"ai_operations\",\n          description: \"PII detection not enabled - potential privacy risk\",\n          routingPath: routingPath.routeType,\n          recommendation: \"Enable PII detection and redaction\",\n        });\n      }\n\n      if (!auditTrailCompliance.correlationIdTracking) {\n        warnings.push({\n          id: \"correlation-tracking\",\n          category: \"security\",\n          description: \"Correlation ID tracking not implemented\",\n          routingPath: routingPath.routeType,\n          recommendation:\n            \"Implement correlation ID tracking for request tracing\",\n        });\n      }\n\n      // Calculate compliance score\n      const totalChecks = 12; // Total number of compliance checks\n      const violationPenalty = violations.reduce((penalty, violation) => {\n        switch (violation.severity) {\n          case \"critical\":\n            return penalty + 25;\n          case \"high\":\n            return penalty + 15;\n          case \"medium\":\n            return penalty + 10;\n          case \"low\":\n            return penalty + 5;\n          default:\n            return penalty;\n        }\n      }, 0);\n\n      const complianceScore = Math.max(0, 100 - violationPenalty);\n      const isCompliant = violations.length === 0 && complianceScore >= 95;\n\n      const result: GDPRComplianceValidation = {\n        routingPath,\n        isCompliant,\n        complianceScore,\n        violations,\n        warnings,\n        dataProcessingCompliance,\n        auditTrailCompliance,\n        timestamp,\n        correlationId,\n      };\n\n      // Log compliance validation to audit trail\n      await this.auditTrail.logEvent({\n        eventType: \"gdpr_compliance_validation\",\n        requestId: correlationId,\n        provider: routingPath.provider,\n        complianceStatus: isCompliant ? \"compliant\" : \"violation\",\n        metadata: {\n          routingPath: routingPath.routeType,\n          operationType: routingPath.operationType,\n          complianceScore,\n          violationsCount: violations.length,\n          warningsCount: warnings.length,\n          processingTimeMs: Date.now() - startTime,\n        },\n      });\n\n      this.logger.info(\"GDPR compliance validation completed\", {\n        routingPath: routingPath.routeType,\n        provider: routingPath.provider,\n        isCompliant,\n        complianceScore,\n        violations: violations.length,\n        warnings: warnings.length,\n        correlationId,\n        processingTimeMs: Date.now() - startTime,\n      });\n\n      return result;\n    } catch (error) {\n      const errorMessage =\n        error instanceof Error ? error.message : String(error);\n\n      this.logger.error(\"GDPR compliance validation failed\", {\n        routingPath: routingPath.routeType,\n        provider: routingPath.provider,\n        error: errorMessage,\n        correlationId,\n      });\n\n      // Log error to audit trail\n      await this.auditTrail.logEvent({\n        eventType: \"gdpr_compliance_validation\",\n        requestId: correlationId,\n        provider: routingPath.provider,\n        complianceStatus: \"violation\",\n        error: {\n          type: \"validation_error\",\n          message: errorMessage,\n        },\n      });\n\n      // Return non-compliant result on error\n      return {\n        routingPath,\n        isCompliant: false,\n        complianceScore: 0,\n        violations: [\n          {\n            id: \"validation-error\",\n            severity: \"critical\",\n            category: \"security\",\n            description: `GDPR compliance validation failed: ${errorMessage}`,\n            routingPath: routingPath.routeType,\n            remediation: \"Fix validation system and retry\",\n            gdprArticle:\n              \"Article 25 - Data protection by design and by default\",\n          },\n        ],\n        warnings: [],\n        dataProcessingCompliance: {\n          lawfulBasisDocumented: false,\n          purposeLimitationEnforced: false,\n          dataMinimizationImplemented: false,\n          consentManagementActive: false,\n          piiDetectionEnabled: false,\n          dataRetentionPoliciesActive: false,\n          euDataResidencyCompliant: false,\n        },\n        auditTrailCompliance: {\n          auditLoggingEnabled: false,\n          correlationIdTracking: false,\n          routingPathLogged: false,\n          complianceChecksLogged: false,\n          dataProcessingActivitiesLogged: false,\n          retentionPolicyCompliant: false,\n          integrityCheckingEnabled: false,\n        },\n        timestamp,\n        correlationId,\n      };\n    }\n  }\n\n  /**\n   * Validate data processing compliance for routing path\n   */\n  private async validateDataProcessingCompliance(\n    routingPath: HybridRoutingPath\n  ): Promise<DataProcessingCompliance> {\n    // Check if lawful basis is documented\n    const lawfulBasisDocumented = await this.checkLawfulBasisDocumentation(\n      routingPath\n    );\n\n    // Check purpose limitation enforcement\n    const purposeLimitationEnforced = await this.checkPurposeLimitation(\n      routingPath\n    );\n\n    // Check data minimization implementation\n    const dataMinimizationImplemented = await this.checkDataMinimization(\n      routingPath\n    );\n\n    // Check consent management\n    const consentManagementActive = await this.checkConsentManagement(\n      routingPath\n    );\n\n    // Check PII detection\n    const piiDetectionEnabled = await this.checkPIIDetection(routingPath);\n\n    // Check data retention policies\n    const dataRetentionPoliciesActive = await this.checkDataRetentionPolicies(\n      routingPath\n    );\n\n    // Check EU data residency\n    const euDataResidencyCompliant = await this.checkEUDataResidency(\n      routingPath\n    );\n\n    return {\n      lawfulBasisDocumented,\n      purposeLimitationEnforced,\n      dataMinimizationImplemented,\n      consentManagementActive,\n      piiDetectionEnabled,\n      dataRetentionPoliciesActive,\n      euDataResidencyCompliant,\n    };\n  }\n\n  /**\n   * Validate audit trail compliance for routing path\n   */\n  private async validateAuditTrailCompliance(\n    routingPath: HybridRoutingPath\n  ): Promise<AuditTrailCompliance> {\n    // Check audit logging\n    const auditLoggingEnabled = await this.checkAuditLogging(routingPath);\n\n    // Check correlation ID tracking\n    const correlationIdTracking = await this.checkCorrelationIdTracking(\n      routingPath\n    );\n\n    // Check routing path logging\n    const routingPathLogged = await this.checkRoutingPathLogging(routingPath);\n\n    // Check compliance checks logging\n    const complianceChecksLogged = await this.checkComplianceChecksLogging(\n      routingPath\n    );\n\n    // Check data processing activities logging\n    const dataProcessingActivitiesLogged =\n      await this.checkDataProcessingActivitiesLogging(routingPath);\n\n    // Check retention policy compliance\n    const retentionPolicyCompliant = await this.checkRetentionPolicyCompliance(\n      routingPath\n    );\n\n    // Check integrity checking\n    const integrityCheckingEnabled = await this.checkIntegrityChecking(\n      routingPath\n    );\n\n    return {\n      auditLoggingEnabled,\n      correlationIdTracking,\n      routingPathLogged,\n      complianceChecksLogged,\n      dataProcessingActivitiesLogged,\n      retentionPolicyCompliant,\n      integrityCheckingEnabled,\n    };\n  }\n\n  /**\n   * Perform routing-specific GDPR checks\n   */\n  private async performRoutingSpecificGDPRChecks(\n    routingPath: HybridRoutingPath\n  ): Promise<boolean> {\n    if (routingPath.routeType === \"direct_bedrock\") {\n      return await this.validateDirectBedrockGDPRCompliance(routingPath);\n    } else {\n      return await this.validateMCPIntegrationGDPRCompliance(routingPath);\n    }\n  }\n\n  /**\n   * Validate direct Bedrock GDPR compliance\n   */\n  private async validateDirectBedrockGDPRCompliance(\n    routingPath: HybridRoutingPath\n  ): Promise<boolean> {\n    // Check if direct Bedrock access maintains GDPR compliance\n    // This includes checking AWS Bedrock's GDPR compliance status\n    const agreement = this.providerCompliance.getAgreement(\n      routingPath.provider\n    );\n\n    if (!agreement) {\n      return false;\n    }\n\n    // Verify AWS Bedrock specific GDPR requirements\n    return (\n      agreement.gdprCompliant &&\n      agreement.euDataResidency &&\n      agreement.noTrainingOnCustomerData &&\n      agreement.dataProcessingAgreement\n    );\n  }\n\n  /**\n   * Validate MCP integration GDPR compliance\n   */\n  private async validateMCPIntegrationGDPRCompliance(\n    routingPath: HybridRoutingPath\n  ): Promise<boolean> {\n    // Check if MCP integration maintains GDPR compliance\n    // This includes checking the MCP layer's compliance with GDPR\n    const agreement = this.providerCompliance.getAgreement(\n      routingPath.provider\n    );\n\n    if (!agreement) {\n      return false;\n    }\n\n    // Verify MCP integration specific GDPR requirements\n    // MCP should not add additional data processing that violates GDPR\n    return agreement.gdprCompliant && agreement.dataProcessingAgreement;\n  }\n\n  // Individual compliance check methods\n  private async checkLawfulBasisDocumentation(\n    routingPath: HybridRoutingPath\n  ): Promise<boolean> {\n    // Check if lawful basis is documented for this routing path\n    // This would typically check configuration or database records\n    return true; // Placeholder - implement actual check\n  }\n\n  private async checkPurposeLimitation(\n    routingPath: HybridRoutingPath\n  ): Promise<boolean> {\n    // Check if purpose limitation is enforced\n    return true; // Placeholder - implement actual check\n  }\n\n  private async checkDataMinimization(\n    routingPath: HybridRoutingPath\n  ): Promise<boolean> {\n    // Check if data minimization is implemented\n    return true; // Placeholder - implement actual check\n  }\n\n  private async checkConsentManagement(\n    routingPath: HybridRoutingPath\n  ): Promise<boolean> {\n    // Check if consent management is active\n    return true; // Placeholder - implement actual check\n  }\n\n  private async checkPIIDetection(\n    routingPath: HybridRoutingPath\n  ): Promise<boolean> {\n    // Check if PII detection is enabled\n    return true; // Placeholder - implement actual check\n  }\n\n  private async checkDataRetentionPolicies(\n    routingPath: HybridRoutingPath\n  ): Promise<boolean> {\n    // Check if data retention policies are active\n    return true; // Placeholder - implement actual check\n  }\n\n  private async checkEUDataResidency(\n    routingPath: HybridRoutingPath\n  ): Promise<boolean> {\n    // Check if EU data residency is compliant\n    const agreement = this.providerCompliance.getAgreement(\n      routingPath.provider\n    );\n    return agreement?.euDataResidency || false;\n  }\n\n  private async checkAuditLogging(\n    routingPath: HybridRoutingPath\n  ): Promise<boolean> {\n    // Check if audit logging is enabled\n    return true; // Placeholder - implement actual check\n  }\n\n  private async checkCorrelationIdTracking(\n    routingPath: HybridRoutingPath\n  ): Promise<boolean> {\n    // Check if correlation ID tracking is implemented\n    return true; // Placeholder - implement actual check\n  }\n\n  private async checkRoutingPathLogging(\n    routingPath: HybridRoutingPath\n  ): Promise<boolean> {\n    // Check if routing path decisions are logged\n    return true; // Placeholder - implement actual check\n  }\n\n  private async checkComplianceChecksLogging(\n    routingPath: HybridRoutingPath\n  ): Promise<boolean> {\n    // Check if compliance checks are logged\n    return true; // Placeholder - implement actual check\n  }\n\n  private async checkDataProcessingActivitiesLogging(\n    routingPath: HybridRoutingPath\n  ): Promise<boolean> {\n    // Check if data processing activities are logged\n    return true; // Placeholder - implement actual check\n  }\n\n  private async checkRetentionPolicyCompliance(\n    routingPath: HybridRoutingPath\n  ): Promise<boolean> {\n    // Check if retention policy is compliant\n    return true; // Placeholder - implement actual check\n  }\n\n  private async checkIntegrityChecking(\n    routingPath: HybridRoutingPath\n  ): Promise<boolean> {\n    // Check if integrity checking is enabled\n    return true; // Placeholder - implement actual check\n  }\n\n  /**\n   * Generate comprehensive hybrid compliance report\n   */\n  async generateHybridComplianceReport(): Promise<HybridComplianceReport> {\n    const timestamp = new Date();\n    const correlationId = `hybrid-compliance-${Date.now()}`;\n\n    // Validate both routing paths\n    const directBedrockPath: HybridRoutingPath = {\n      routeType: \"direct_bedrock\",\n      provider: \"bedrock\",\n      operationType: \"infrastructure\",\n      priority: \"critical\",\n    };\n\n    const mcpIntegrationPath: HybridRoutingPath = {\n      routeType: \"mcp_integration\",\n      provider: \"bedrock\",\n      operationType: \"standard_analysis\",\n      priority: \"medium\",\n    };\n\n    const directBedrockCompliance = await this.validateRoutingPathCompliance(\n      directBedrockPath,\n      `${correlationId}-direct`\n    );\n\n    const mcpIntegrationCompliance = await this.validateRoutingPathCompliance(\n      mcpIntegrationPath,\n      `${correlationId}-mcp`\n    );\n\n    // Calculate overall compliance\n    const averageScore =\n      (directBedrockCompliance.complianceScore +\n        mcpIntegrationCompliance.complianceScore) /\n      2;\n    const overallCompliance: HybridComplianceReport[\"overallCompliance\"] =\n      averageScore >= 95\n        ? \"compliant\"\n        : averageScore >= 80\n        ? \"partial\"\n        : \"non_compliant\";\n\n    // Check cross-path compliance\n    const crossPathCompliance = {\n      dataConsistency: true, // Placeholder - implement actual check\n      auditTrailContinuity: true, // Placeholder - implement actual check\n      consentPropagation: true, // Placeholder - implement actual check\n      piiHandlingConsistency: true, // Placeholder - implement actual check\n    };\n\n    // Generate recommendations\n    const recommendations: string[] = [];\n    const criticalIssues: string[] = [];\n    const nextActions: HybridComplianceReport[\"nextActions\"] = [];\n\n    // Collect critical issues and recommendations\n    [directBedrockCompliance, mcpIntegrationCompliance].forEach(\n      (compliance) => {\n        compliance.violations.forEach((violation) => {\n          if (violation.severity === \"critical\") {\n            criticalIssues.push(\n              `${violation.routingPath}: ${violation.description}`\n            );\n            nextActions.push({\n              action: violation.remediation,\n              priority: \"critical\",\n              dueDate: new Date(Date.now() + 24 * 60 * 60 * 1000), // 24 hours\n              routingPath: violation.routingPath,\n            });\n          }\n        });\n\n        compliance.warnings.forEach((warning) => {\n          recommendations.push(\n            `${warning.routingPath}: ${warning.recommendation}`\n          );\n        });\n      }\n    );\n\n    // Add general recommendations\n    if (averageScore < 100) {\n      recommendations.push(\n        \"Implement comprehensive GDPR compliance monitoring\"\n      );\n      recommendations.push(\"Regular compliance audits for both routing paths\");\n      recommendations.push(\"Staff training on GDPR requirements\");\n    }\n\n    return {\n      timestamp,\n      overallCompliance,\n      complianceScore: Math.round(averageScore),\n      routingPathCompliance: {\n        directBedrock: directBedrockCompliance,\n        mcpIntegration: mcpIntegrationCompliance,\n      },\n      crossPathCompliance,\n      recommendations,\n      criticalIssues,\n      nextActions,\n    };\n  }\n\n  /**\n   * Validate GDPR compliance before routing decision\n   */\n  async validateBeforeRouting(\n    routingPath: HybridRoutingPath,\n    correlationId: string\n  ): Promise<{ allowed: boolean; reason: string }> {\n    const compliance = await this.validateRoutingPathCompliance(\n      routingPath,\n      correlationId\n    );\n\n    if (!compliance.isCompliant) {\n      const criticalViolations = compliance.violations.filter(\n        (v) => v.severity === \"critical\"\n      );\n      if (criticalViolations.length > 0) {\n        return {\n          allowed: false,\n          reason: `Critical GDPR violations: ${criticalViolations\n            .map((v) => v.description)\n            .join(\", \")}`,\n        };\n      }\n    }\n\n    if (compliance.complianceScore < 80) {\n      return {\n        allowed: false,\n        reason: `GDPR compliance score too low: ${compliance.complianceScore}%`,\n      };\n    }\n\n    return {\n      allowed: true,\n      reason: \"GDPR compliance validated\",\n    };\n  }\n}\n\n// Export singleton instance\nexport const gdprHybridComplianceValidator =\n  new GDPRHybridComplianceValidator();\n"],"version":3}