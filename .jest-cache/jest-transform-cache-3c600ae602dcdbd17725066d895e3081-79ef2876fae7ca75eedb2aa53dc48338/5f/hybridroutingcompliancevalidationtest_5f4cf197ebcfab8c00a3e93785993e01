64b2fd16167d0ce3ef2322d9c7e762ab
"use strict";
/**
 * Hybrid Routing Compliance Validation Tests
 *
 * Tests compliance validation for both direct Bedrock and MCP integration routing paths
 * in the Bedrock Support Manager hybrid architecture.
 */
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const globals_1 = require("@jest/globals");
// Mock dependencies
globals_1.jest.mock("../audit-trail-system", () => ({
    AuditTrailSystem: globals_1.jest.fn().mockImplementation(() => ({
        logEvent: globals_1.jest.fn().mockResolvedValue(undefined),
    })),
}));
globals_1.jest.mock("../basic-logger", () => ({
    BasicLogger: globals_1.jest.fn().mockImplementation(() => ({
        info: globals_1.jest.fn(),
        error: globals_1.jest.fn(),
        warn: globals_1.jest.fn(),
    })),
}));
globals_1.jest.mock("../../compliance/gdpr-compliance-validator", () => ({
    GDPRComplianceValidator: globals_1.jest.fn().mockImplementation(() => ({
        validateCompliance: globals_1.jest.fn().mockResolvedValue({
            overallStatus: "compliant",
            complianceScore: 100,
        }),
    })),
}));
const compliance_integration_1 = require("../compliance-integration");
const gdpr_hybrid_compliance_validator_1 = require("../gdpr-hybrid-compliance-validator");
const provider_agreement_compliance_1 = require("../provider-agreement-compliance");
(0, globals_1.describe)("Hybrid Routing Compliance Validation", () => {
    let complianceIntegration;
    let gdprValidator;
    let providerCompliance;
    let mockRequest;
    (0, globals_1.beforeEach)(() => {
        complianceIntegration = new compliance_integration_1.ComplianceIntegration();
        gdprValidator = new gdpr_hybrid_compliance_validator_1.GDPRHybridComplianceValidator();
        providerCompliance = new provider_agreement_compliance_1.ProviderAgreementCompliance();
        mockRequest = {
            prompt: "Test infrastructure audit request",
            context: {
                domain: "infrastructure",
                intent: "audit",
            },
        };
    });
    (0, globals_1.describe)("Direct Bedrock Routing Path Compliance", () => {
        let directBedrockPath;
        (0, globals_1.beforeEach)(() => {
            directBedrockPath = {
                routeType: "direct_bedrock",
                provider: "bedrock",
                operationType: "infrastructure",
                priority: "critical",
            };
        });
        (0, globals_1.it)("should validate GDPR compliance for direct Bedrock operations", () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const correlationId = "test-direct-bedrock-gdpr";
            const result = yield gdprValidator.validateRoutingPathCompliance(directBedrockPath, correlationId);
            (0, globals_1.expect)(result).toBeDefined();
            (0, globals_1.expect)(result.routingPath.routeType).toBe("direct_bedrock");
            (0, globals_1.expect)(result.routingPath.provider).toBe("bedrock");
            (0, globals_1.expect)(result.correlationId).toBe(correlationId);
            (0, globals_1.expect)(typeof result.isCompliant).toBe("boolean");
            (0, globals_1.expect)(typeof result.complianceScore).toBe("number");
            (0, globals_1.expect)(result.complianceScore).toBeGreaterThanOrEqual(0);
            (0, globals_1.expect)(result.complianceScore).toBeLessThanOrEqual(100);
        }));
        (0, globals_1.it)("should validate provider agreement compliance for direct Bedrock", () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const result = yield complianceIntegration.performComplianceCheck(mockRequest, "bedrock", "test-direct-bedrock-provider");
            (0, globals_1.expect)(result.allowed).toBe(true);
            (0, globals_1.expect)(result.provider).toBe("bedrock");
            (0, globals_1.expect)(result.complianceScore).toBeGreaterThan(80);
            (0, globals_1.expect)(result.agreementStatus).toBe("active");
            (0, globals_1.expect)(result.violations).toHaveLength(0);
        }));
        (0, globals_1.it)("should validate data processing compliance for direct Bedrock", () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const correlationId = "test-direct-bedrock-data-processing";
            const result = yield gdprValidator.validateRoutingPathCompliance(directBedrockPath, correlationId);
            (0, globals_1.expect)(result.dataProcessingCompliance).toBeDefined();
            (0, globals_1.expect)(typeof result.dataProcessingCompliance.lawfulBasisDocumented).toBe("boolean");
            (0, globals_1.expect)(typeof result.dataProcessingCompliance.purposeLimitationEnforced).toBe("boolean");
            (0, globals_1.expect)(typeof result.dataProcessingCompliance.dataMinimizationImplemented).toBe("boolean");
            (0, globals_1.expect)(typeof result.dataProcessingCompliance.euDataResidencyCompliant).toBe("boolean");
        }));
        (0, globals_1.it)("should validate audit trail compliance for direct Bedrock", () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const correlationId = "test-direct-bedrock-audit-trail";
            const result = yield gdprValidator.validateRoutingPathCompliance(directBedrockPath, correlationId);
            (0, globals_1.expect)(result.auditTrailCompliance).toBeDefined();
            (0, globals_1.expect)(typeof result.auditTrailCompliance.auditLoggingEnabled).toBe("boolean");
            (0, globals_1.expect)(typeof result.auditTrailCompliance.correlationIdTracking).toBe("boolean");
            (0, globals_1.expect)(typeof result.auditTrailCompliance.routingPathLogged).toBe("boolean");
            (0, globals_1.expect)(typeof result.auditTrailCompliance.integrityCheckingEnabled).toBe("boolean");
        }));
        (0, globals_1.it)("should validate emergency operations compliance for direct Bedrock", () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const emergencyPath = {
                routeType: "direct_bedrock",
                provider: "bedrock",
                operationType: "emergency",
                priority: "critical",
            };
            const correlationId = "test-direct-bedrock-emergency";
            const result = yield gdprValidator.validateRoutingPathCompliance(emergencyPath, correlationId);
            (0, globals_1.expect)(result.routingPath.operationType).toBe("emergency");
            (0, globals_1.expect)(result.routingPath.priority).toBe("critical");
            // Emergency operations should still maintain compliance
            (0, globals_1.expect)(result.dataProcessingCompliance).toBeDefined();
            (0, globals_1.expect)(result.auditTrailCompliance).toBeDefined();
        }));
        (0, globals_1.it)("should validate infrastructure audit operations compliance", () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const infrastructurePath = {
                routeType: "direct_bedrock",
                provider: "bedrock",
                operationType: "infrastructure",
                priority: "critical",
            };
            const correlationId = "test-direct-bedrock-infrastructure";
            const result = yield gdprValidator.validateRoutingPathCompliance(infrastructurePath, correlationId);
            (0, globals_1.expect)(result.routingPath.operationType).toBe("infrastructure");
            // Infrastructure operations should have high compliance requirements
            (0, globals_1.expect)(result.dataProcessingCompliance.euDataResidencyCompliant).toBe(true);
        }));
        (0, globals_1.it)("should validate meta monitoring operations compliance", () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const metaMonitorPath = {
                routeType: "direct_bedrock",
                provider: "bedrock",
                operationType: "meta_monitor",
                priority: "high",
            };
            const correlationId = "test-direct-bedrock-meta-monitor";
            const result = yield gdprValidator.validateRoutingPathCompliance(metaMonitorPath, correlationId);
            (0, globals_1.expect)(result.routingPath.operationType).toBe("meta_monitor");
            (0, globals_1.expect)(result.routingPath.priority).toBe("high");
        }));
    });
    (0, globals_1.describe)("MCP Integration Routing Path Compliance", () => {
        let mcpIntegrationPath;
        (0, globals_1.beforeEach)(() => {
            mcpIntegrationPath = {
                routeType: "mcp_integration",
                provider: "google",
                operationType: "standard_analysis",
                priority: "medium",
            };
        });
        (0, globals_1.it)("should validate GDPR compliance for MCP integration operations", () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const correlationId = "test-mcp-integration-gdpr";
            const result = yield gdprValidator.validateRoutingPathCompliance(mcpIntegrationPath, correlationId);
            (0, globals_1.expect)(result).toBeDefined();
            (0, globals_1.expect)(result.routingPath.routeType).toBe("mcp_integration");
            (0, globals_1.expect)(result.routingPath.provider).toBe("google");
            (0, globals_1.expect)(result.correlationId).toBe(correlationId);
            (0, globals_1.expect)(typeof result.isCompliant).toBe("boolean");
            (0, globals_1.expect)(typeof result.complianceScore).toBe("number");
        }));
        (0, globals_1.it)("should validate provider agreement compliance for MCP integration", () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const result = yield complianceIntegration.performComplianceCheck(mockRequest, "google", "test-mcp-integration-provider");
            (0, globals_1.expect)(result.allowed).toBe(true);
            (0, globals_1.expect)(result.provider).toBe("google");
            (0, globals_1.expect)(result.complianceScore).toBeGreaterThan(70);
            (0, globals_1.expect)(result.agreementStatus).toBe("active");
        }));
        (0, globals_1.it)("should validate data processing compliance for MCP integration", () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const correlationId = "test-mcp-integration-data-processing";
            const result = yield gdprValidator.validateRoutingPathCompliance(mcpIntegrationPath, correlationId);
            (0, globals_1.expect)(result.dataProcessingCompliance).toBeDefined();
            (0, globals_1.expect)(typeof result.dataProcessingCompliance.lawfulBasisDocumented).toBe("boolean");
            (0, globals_1.expect)(typeof result.dataProcessingCompliance.purposeLimitationEnforced).toBe("boolean");
            (0, globals_1.expect)(typeof result.dataProcessingCompliance.dataMinimizationImplemented).toBe("boolean");
        }));
        (0, globals_1.it)("should validate Kiro communication operations compliance", () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const kiroCommPath = {
                routeType: "mcp_integration",
                provider: "bedrock",
                operationType: "kiro_communication",
                priority: "medium",
            };
            const correlationId = "test-mcp-integration-kiro-comm";
            const result = yield gdprValidator.validateRoutingPathCompliance(kiroCommPath, correlationId);
            (0, globals_1.expect)(result.routingPath.operationType).toBe("kiro_communication");
            (0, globals_1.expect)(result.routingPath.routeType).toBe("mcp_integration");
        }));
        (0, globals_1.it)("should validate standard analysis operations compliance", () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const standardAnalysisPath = {
                routeType: "mcp_integration",
                provider: "google",
                operationType: "standard_analysis",
                priority: "medium",
            };
            const correlationId = "test-mcp-integration-standard-analysis";
            const result = yield gdprValidator.validateRoutingPathCompliance(standardAnalysisPath, correlationId);
            (0, globals_1.expect)(result.routingPath.operationType).toBe("standard_analysis");
            (0, globals_1.expect)(result.routingPath.provider).toBe("google");
        }));
        (0, globals_1.it)("should validate background tasks operations compliance", () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const backgroundTasksPath = {
                routeType: "mcp_integration",
                provider: "meta",
                operationType: "background_tasks",
                priority: "low",
            };
            const correlationId = "test-mcp-integration-background-tasks";
            const result = yield gdprValidator.validateRoutingPathCompliance(backgroundTasksPath, correlationId);
            (0, globals_1.expect)(result.routingPath.operationType).toBe("background_tasks");
            (0, globals_1.expect)(result.routingPath.priority).toBe("low");
        }));
    });
    (0, globals_1.describe)("Cross-Path Compliance Validation", () => {
        (0, globals_1.it)("should validate compliance consistency between routing paths", () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const directBedrockPath = {
                routeType: "direct_bedrock",
                provider: "bedrock",
                operationType: "infrastructure",
                priority: "critical",
            };
            const mcpIntegrationPath = {
                routeType: "mcp_integration",
                provider: "bedrock",
                operationType: "standard_analysis",
                priority: "medium",
            };
            const directResult = yield gdprValidator.validateRoutingPathCompliance(directBedrockPath, "test-cross-path-direct");
            const mcpResult = yield gdprValidator.validateRoutingPathCompliance(mcpIntegrationPath, "test-cross-path-mcp");
            // Both paths should maintain consistent compliance standards
            (0, globals_1.expect)(directResult.dataProcessingCompliance.euDataResidencyCompliant).toBe(mcpResult.dataProcessingCompliance.euDataResidencyCompliant);
            (0, globals_1.expect)(directResult.auditTrailCompliance.auditLoggingEnabled).toBe(mcpResult.auditTrailCompliance.auditLoggingEnabled);
        }));
        (0, globals_1.it)("should generate comprehensive hybrid compliance report", () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const report = yield gdprValidator.generateHybridComplianceReport();
            (0, globals_1.expect)(report).toBeDefined();
            (0, globals_1.expect)(report.timestamp).toBeInstanceOf(Date);
            (0, globals_1.expect)(["compliant", "non_compliant", "partial"]).toContain(report.overallCompliance);
            (0, globals_1.expect)(typeof report.complianceScore).toBe("number");
            // Validate both routing paths are included
            (0, globals_1.expect)(report.routingPathCompliance.directBedrock).toBeDefined();
            (0, globals_1.expect)(report.routingPathCompliance.mcpIntegration).toBeDefined();
            (0, globals_1.expect)(report.routingPathCompliance.directBedrock.routingPath.routeType).toBe("direct_bedrock");
            (0, globals_1.expect)(report.routingPathCompliance.mcpIntegration.routingPath.routeType).toBe("mcp_integration");
            // Validate cross-path compliance
            (0, globals_1.expect)(report.crossPathCompliance).toBeDefined();
            (0, globals_1.expect)(typeof report.crossPathCompliance.dataConsistency).toBe("boolean");
            (0, globals_1.expect)(typeof report.crossPathCompliance.auditTrailContinuity).toBe("boolean");
            (0, globals_1.expect)(typeof report.crossPathCompliance.consentPropagation).toBe("boolean");
            (0, globals_1.expect)(typeof report.crossPathCompliance.piiHandlingConsistency).toBe("boolean");
        }));
        (0, globals_1.it)("should validate routing decision compliance", () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const directBedrockPath = {
                routeType: "direct_bedrock",
                provider: "bedrock",
                operationType: "emergency",
                priority: "critical",
            };
            const mcpIntegrationPath = {
                routeType: "mcp_integration",
                provider: "google",
                operationType: "standard_analysis",
                priority: "medium",
            };
            const directResult = yield gdprValidator.validateBeforeRouting(directBedrockPath, "test-routing-decision-direct");
            const mcpResult = yield gdprValidator.validateBeforeRouting(mcpIntegrationPath, "test-routing-decision-mcp");
            (0, globals_1.expect)(directResult).toBeDefined();
            (0, globals_1.expect)(typeof directResult.allowed).toBe("boolean");
            (0, globals_1.expect)(typeof directResult.reason).toBe("string");
            (0, globals_1.expect)(mcpResult).toBeDefined();
            (0, globals_1.expect)(typeof mcpResult.allowed).toBe("boolean");
            (0, globals_1.expect)(typeof mcpResult.reason).toBe("string");
        }));
    });
    (0, globals_1.describe)("Provider-Specific Compliance Validation", () => {
        (0, globals_1.it)("should validate AWS Bedrock compliance for both routing paths", () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const directPath = {
                routeType: "direct_bedrock",
                provider: "bedrock",
                operationType: "infrastructure",
                priority: "critical",
            };
            const mcpPath = {
                routeType: "mcp_integration",
                provider: "bedrock",
                operationType: "kiro_communication",
                priority: "medium",
            };
            const directResult = yield gdprValidator.validateRoutingPathCompliance(directPath, "test-bedrock-direct");
            const mcpResult = yield gdprValidator.validateRoutingPathCompliance(mcpPath, "test-bedrock-mcp");
            (0, globals_1.expect)(directResult.routingPath.provider).toBe("bedrock");
            (0, globals_1.expect)(mcpResult.routingPath.provider).toBe("bedrock");
            // Both should maintain AWS Bedrock compliance standards
            const directProviderResult = yield complianceIntegration.performComplianceCheck(mockRequest, "bedrock", "test-bedrock-direct-provider");
            const mcpProviderResult = yield complianceIntegration.performComplianceCheck(mockRequest, "bedrock", "test-bedrock-mcp-provider");
            (0, globals_1.expect)(directProviderResult.allowed).toBe(true);
            (0, globals_1.expect)(mcpProviderResult.allowed).toBe(true);
            (0, globals_1.expect)(directProviderResult.complianceScore).toBeGreaterThan(80);
            (0, globals_1.expect)(mcpProviderResult.complianceScore).toBeGreaterThan(80);
        }));
        (0, globals_1.it)("should validate Google AI compliance for MCP integration", () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const googlePath = {
                routeType: "mcp_integration",
                provider: "google",
                operationType: "standard_analysis",
                priority: "medium",
            };
            const result = yield gdprValidator.validateRoutingPathCompliance(googlePath, "test-google-mcp");
            (0, globals_1.expect)(result.routingPath.provider).toBe("google");
            const providerResult = yield complianceIntegration.performComplianceCheck(mockRequest, "google", "test-google-provider");
            (0, globals_1.expect)(providerResult.allowed).toBe(true);
            (0, globals_1.expect)(providerResult.complianceScore).toBeGreaterThan(70);
        }));
        (0, globals_1.it)("should validate Meta AI compliance for MCP integration", () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const metaPath = {
                routeType: "mcp_integration",
                provider: "meta",
                operationType: "background_tasks",
                priority: "low",
            };
            const result = yield gdprValidator.validateRoutingPathCompliance(metaPath, "test-meta-mcp");
            (0, globals_1.expect)(result.routingPath.provider).toBe("meta");
            const providerResult = yield complianceIntegration.performComplianceCheck(mockRequest, "meta", "test-meta-provider");
            (0, globals_1.expect)(providerResult.allowed).toBe(true);
            (0, globals_1.expect)(providerResult.complianceScore).toBeGreaterThan(80);
        }));
    });
    (0, globals_1.describe)("Operation Type Compliance Validation", () => {
        const operationTypes = [
            {
                type: "emergency",
                preferredRoute: "direct_bedrock",
                priority: "critical",
            },
            {
                type: "infrastructure",
                preferredRoute: "direct_bedrock",
                priority: "critical",
            },
            {
                type: "meta_monitor",
                preferredRoute: "direct_bedrock",
                priority: "high",
            },
            {
                type: "implementation",
                preferredRoute: "direct_bedrock",
                priority: "high",
            },
            {
                type: "kiro_communication",
                preferredRoute: "mcp_integration",
                priority: "medium",
            },
            {
                type: "standard_analysis",
                preferredRoute: "mcp_integration",
                priority: "medium",
            },
            {
                type: "background_tasks",
                preferredRoute: "mcp_integration",
                priority: "low",
            },
        ];
        operationTypes.forEach(({ type, preferredRoute, priority }) => {
            (0, globals_1.it)(`should validate ${type} operations compliance on ${preferredRoute}`, () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
                const path = {
                    routeType: preferredRoute,
                    provider: preferredRoute === "direct_bedrock" ? "bedrock" : "google",
                    operationType: type,
                    priority,
                };
                const result = yield gdprValidator.validateRoutingPathCompliance(path, `test-${type}-${preferredRoute}`);
                (0, globals_1.expect)(result.routingPath.operationType).toBe(type);
                (0, globals_1.expect)(result.routingPath.routeType).toBe(preferredRoute);
                (0, globals_1.expect)(result.routingPath.priority).toBe(priority);
                // All operations should maintain basic compliance
                (0, globals_1.expect)(result.dataProcessingCompliance).toBeDefined();
                (0, globals_1.expect)(result.auditTrailCompliance).toBeDefined();
            }));
        });
    });
    (0, globals_1.describe)("Priority Level Compliance Validation", () => {
        const priorities = [
            "critical",
            "high",
            "medium",
            "low",
        ];
        priorities.forEach((priority) => {
            (0, globals_1.it)(`should validate ${priority} priority operations compliance`, () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
                const directPath = {
                    routeType: "direct_bedrock",
                    provider: "bedrock",
                    operationType: "infrastructure",
                    priority,
                };
                const mcpPath = {
                    routeType: "mcp_integration",
                    provider: "google",
                    operationType: "standard_analysis",
                    priority,
                };
                const directResult = yield gdprValidator.validateRoutingPathCompliance(directPath, `test-${priority}-direct`);
                const mcpResult = yield gdprValidator.validateRoutingPathCompliance(mcpPath, `test-${priority}-mcp`);
                (0, globals_1.expect)(directResult.routingPath.priority).toBe(priority);
                (0, globals_1.expect)(mcpResult.routingPath.priority).toBe(priority);
                // Higher priority operations should maintain stricter compliance
                if (priority === "critical") {
                    (0, globals_1.expect)(directResult.dataProcessingCompliance.euDataResidencyCompliant).toBe(true);
                    (0, globals_1.expect)(directResult.auditTrailCompliance.auditLoggingEnabled).toBe(true);
                }
            }));
        });
    });
    (0, globals_1.describe)("Error Handling and Edge Cases", () => {
        (0, globals_1.it)("should handle invalid provider gracefully", () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const invalidPath = {
                routeType: "direct_bedrock",
                provider: "invalid",
                operationType: "infrastructure",
                priority: "critical",
            };
            const result = yield gdprValidator.validateRoutingPathCompliance(invalidPath, "test-invalid-provider");
            (0, globals_1.expect)(result.isCompliant).toBe(false);
            (0, globals_1.expect)(result.complianceScore).toBe(0);
            (0, globals_1.expect)(result.violations.length).toBeGreaterThan(0);
        }));
        (0, globals_1.it)("should handle compliance check failures gracefully", () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const result = yield complianceIntegration.performComplianceCheck(mockRequest, "unknown", "test-compliance-failure");
            (0, globals_1.expect)(result.allowed).toBe(false);
            (0, globals_1.expect)(result.violations.length).toBeGreaterThan(0);
            (0, globals_1.expect)(result.complianceScore).toBe(0);
        }));
        (0, globals_1.it)("should validate routing decision with compliance failures", () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const invalidPath = {
                routeType: "direct_bedrock",
                provider: "invalid",
                operationType: "infrastructure",
                priority: "critical",
            };
            const result = yield gdprValidator.validateBeforeRouting(invalidPath, "test-routing-failure");
            (0, globals_1.expect)(result.allowed).toBe(false);
            (0, globals_1.expect)(result.reason).toContain("compliance");
        }));
    });
    (0, globals_1.describe)("Compliance Enforcement Integration", () => {
        (0, globals_1.it)("should enforce compliance for direct Bedrock operations", () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            yield (0, globals_1.expect)(complianceIntegration.enforceCompliance(mockRequest, "bedrock", "test-enforce-direct-bedrock")).resolves.not.toThrow();
        }));
        (0, globals_1.it)("should enforce compliance for MCP integration operations", () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            yield (0, globals_1.expect)(complianceIntegration.enforceCompliance(mockRequest, "google", "test-enforce-mcp-integration")).resolves.not.toThrow();
        }));
        (0, globals_1.it)("should block non-compliant operations", () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            yield (0, globals_1.expect)(complianceIntegration.enforceCompliance(mockRequest, "unknown", "test-enforce-non-compliant")).rejects.toThrow("Compliance violation prevents AI request");
        }));
    });
    (0, globals_1.describe)("Compliance Summary and Reporting", () => {
        (0, globals_1.it)("should generate compliance summary for both routing paths", () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const summary = yield complianceIntegration.getComplianceSummary();
            (0, globals_1.expect)(summary.overallCompliance).toMatch(/compliant|warning|non_compliant/);
            (0, globals_1.expect)(summary.providers).toHaveLength(3);
            (0, globals_1.expect)(summary.providers.every((p) => p.provider &&
                typeof p.compliant === "boolean" &&
                typeof p.score === "number")).toBe(true);
            (0, globals_1.expect)(typeof summary.recentViolations).toBe("number");
            (0, globals_1.expect)(typeof summary.pendingActions).toBe("number");
        }));
        (0, globals_1.it)("should provide actionable recommendations for compliance improvements", () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            const report = yield gdprValidator.generateHybridComplianceReport();
            (0, globals_1.expect)(Array.isArray(report.recommendations)).toBe(true);
            (0, globals_1.expect)(Array.isArray(report.criticalIssues)).toBe(true);
            (0, globals_1.expect)(Array.isArray(report.nextActions)).toBe(true);
            report.nextActions.forEach((action) => {
                (0, globals_1.expect)(typeof action.action).toBe("string");
                (0, globals_1.expect)(["low", "medium", "high", "critical"]).toContain(action.priority);
                (0, globals_1.expect)(action.dueDate).toBeInstanceOf(Date);
                (0, globals_1.expect)(["direct_bedrock", "mcp_integration", "both"]).toContain(action.routingPath);
            });
        }));
    });
    (0, globals_1.describe)("Requirement Validation", () => {
        (0, globals_1.it)("should meet Requirement 7: Compliance and Security Maintenance", () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            // Test that all existing GDPR compliance measures remain intact
            const directPath = {
                routeType: "direct_bedrock",
                provider: "bedrock",
                operationType: "infrastructure",
                priority: "critical",
            };
            const mcpPath = {
                routeType: "mcp_integration",
                provider: "google",
                operationType: "standard_analysis",
                priority: "medium",
            };
            const directResult = yield gdprValidator.validateRoutingPathCompliance(directPath, "test-req7-direct");
            const mcpResult = yield gdprValidator.validateRoutingPathCompliance(mcpPath, "test-req7-mcp");
            // GDPR compliance measures should remain intact
            (0, globals_1.expect)(directResult.dataProcessingCompliance.euDataResidencyCompliant).toBe(true);
            (0, globals_1.expect)(mcpResult.dataProcessingCompliance.euDataResidencyCompliant).toBe(true);
            // Audit trails should capture all activities
            (0, globals_1.expect)(directResult.auditTrailCompliance.auditLoggingEnabled).toBe(true);
            (0, globals_1.expect)(mcpResult.auditTrailCompliance.auditLoggingEnabled).toBe(true);
        }));
        (0, globals_1.it)("should meet Requirement 5: Controlled Integration with Existing Systems", () => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
            // Test that compliance integration works with existing systems
            const bedrockResult = yield complianceIntegration.performComplianceCheck(mockRequest, "bedrock", "test-req5-bedrock");
            const googleResult = yield complianceIntegration.performComplianceCheck(mockRequest, "google", "test-req5-google");
            // Existing compliance systems should continue to function
            (0, globals_1.expect)(bedrockResult.allowed).toBe(true);
            (0, globals_1.expect)(googleResult.allowed).toBe(true);
            (0, globals_1.expect)(bedrockResult.complianceScore).toBeGreaterThan(80);
            (0, globals_1.expect)(googleResult.complianceScore).toBeGreaterThan(70);
        }));
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL21hdGJha2gtdmlzaWJpbGl0eS1ib29zdC4yMDI1MDkyMC9zcmMvbGliL2FpLW9yY2hlc3RyYXRvci9fX3Rlc3RzX18vaHlicmlkLXJvdXRpbmctY29tcGxpYW5jZS12YWxpZGF0aW9uLnRlc3QudHMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7OztHQUtHOzs7QUFFSCwyQ0FBdUU7QUFTdkUsb0JBQW9CO0FBQ3BCLGNBQUksQ0FBQyxJQUFJLENBQUMsdUJBQXVCLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUN4QyxnQkFBZ0IsRUFBRSxjQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsa0JBQWtCLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQztRQUNwRCxRQUFRLEVBQUUsY0FBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGlCQUFpQixDQUFDLFNBQVMsQ0FBQztLQUNqRCxDQUFDLENBQUM7Q0FDSixDQUFDLENBQUMsQ0FBQztBQUVKLGNBQUksQ0FBQyxJQUFJLENBQUMsaUJBQWlCLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUNsQyxXQUFXLEVBQUUsY0FBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGtCQUFrQixDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUM7UUFDL0MsSUFBSSxFQUFFLGNBQUksQ0FBQyxFQUFFLEVBQUU7UUFDZixLQUFLLEVBQUUsY0FBSSxDQUFDLEVBQUUsRUFBRTtRQUNoQixJQUFJLEVBQUUsY0FBSSxDQUFDLEVBQUUsRUFBRTtLQUNoQixDQUFDLENBQUM7Q0FDSixDQUFDLENBQUMsQ0FBQztBQUVKLGNBQUksQ0FBQyxJQUFJLENBQUMsNENBQTRDLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUM3RCx1QkFBdUIsRUFBRSxjQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsa0JBQWtCLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQztRQUMzRCxrQkFBa0IsRUFBRSxjQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsaUJBQWlCLENBQUM7WUFDOUMsYUFBYSxFQUFFLFdBQVc7WUFD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QyxZQUFZLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ3hDLElBQUEsZ0JBQU0sRUFBQyxhQUFhLENBQUMsZUFBZSxDQUFDLENBQUMsZUFBZSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1lBQzFELElBQUEsZ0JBQU0sRUFBQyxZQUFZLENBQUMsZUFBZSxDQUFDLENBQUMsZUFBZSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQzNELENBQUMsQ0FBQSxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9tYXRiYWtoLXZpc2liaWxpdHktYm9vc3QuMjAyNTA5MjAvc3JjL2xpYi9haS1vcmNoZXN0cmF0b3IvX190ZXN0c19fL2h5YnJpZC1yb3V0aW5nLWNvbXBsaWFuY2UtdmFsaWRhdGlvbi50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogSHlicmlkIFJvdXRpbmcgQ29tcGxpYW5jZSBWYWxpZGF0aW9uIFRlc3RzXG4gKlxuICogVGVzdHMgY29tcGxpYW5jZSB2YWxpZGF0aW9uIGZvciBib3RoIGRpcmVjdCBCZWRyb2NrIGFuZCBNQ1AgaW50ZWdyYXRpb24gcm91dGluZyBwYXRoc1xuICogaW4gdGhlIEJlZHJvY2sgU3VwcG9ydCBNYW5hZ2VyIGh5YnJpZCBhcmNoaXRlY3R1cmUuXG4gKi9cblxuaW1wb3J0IHsgYmVmb3JlRWFjaCwgZGVzY3JpYmUsIGV4cGVjdCwgaXQsIGplc3QgfSBmcm9tIFwiQGplc3QvZ2xvYmFsc1wiO1xuaW1wb3J0IHsgQ29tcGxpYW5jZUludGVncmF0aW9uIH0gZnJvbSBcIi4uL2NvbXBsaWFuY2UtaW50ZWdyYXRpb25cIjtcbmltcG9ydCB7XG4gIEdEUFJIeWJyaWRDb21wbGlhbmNlVmFsaWRhdG9yLFxuICBIeWJyaWRSb3V0aW5nUGF0aCxcbn0gZnJvbSBcIi4uL2dkcHItaHlicmlkLWNvbXBsaWFuY2UtdmFsaWRhdG9yXCI7XG5pbXBvcnQgeyBQcm92aWRlckFncmVlbWVudENvbXBsaWFuY2UgfSBmcm9tIFwiLi4vcHJvdmlkZXItYWdyZWVtZW50LWNvbXBsaWFuY2VcIjtcbmltcG9ydCB7IEFpUmVxdWVzdCwgUHJvdmlkZXIgfSBmcm9tIFwiLi4vdHlwZXNcIjtcblxuLy8gTW9jayBkZXBlbmRlbmNpZXNcbmplc3QubW9jayhcIi4uL2F1ZGl0LXRyYWlsLXN5c3RlbVwiLCAoKSA9PiAoe1xuICBBdWRpdFRyYWlsU3lzdGVtOiBqZXN0LmZuKCkubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+ICh7XG4gICAgbG9nRXZlbnQ6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh1bmRlZmluZWQpLFxuICB9KSksXG59KSk7XG5cbmplc3QubW9jayhcIi4uL2Jhc2ljLWxvZ2dlclwiLCAoKSA9PiAoe1xuICBCYXNpY0xvZ2dlcjogamVzdC5mbigpLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiAoe1xuICAgIGluZm86IGplc3QuZm4oKSxcbiAgICBlcnJvcjogamVzdC5mbigpLFxuICAgIHdhcm46IGplc3QuZm4oKSxcbiAgfSkpLFxufSkpO1xuXG5qZXN0Lm1vY2soXCIuLi8uLi9jb21wbGlhbmNlL2dkcHItY29tcGxpYW5jZS12YWxpZGF0b3JcIiwgKCkgPT4gKHtcbiAgR0RQUkNvbXBsaWFuY2VWYWxpZGF0b3I6IGplc3QuZm4oKS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4gKHtcbiAgICB2YWxpZGF0ZUNvbXBsaWFuY2U6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICBvdmVyYWxsU3RhdHVzOiBcImNvbXBsaWFudFwiLFxuICAgICAgY29tcGxpYW5jZVNjb3JlOiAxMDAsXG4gICAgfSksXG4gIH0pKSxcbn0pKTtcblxuZGVzY3JpYmUoXCJIeWJyaWQgUm91dGluZyBDb21wbGlhbmNlIFZhbGlkYXRpb25cIiwgKCkgPT4ge1xuICBsZXQgY29tcGxpYW5jZUludGVncmF0aW9uOiBDb21wbGlhbmNlSW50ZWdyYXRpb247XG4gIGxldCBnZHByVmFsaWRhdG9yOiBHRFBSSHlicmlkQ29tcGxpYW5jZVZhbGlkYXRvcjtcbiAgbGV0IHByb3ZpZGVyQ29tcGxpYW5jZTogUHJvdmlkZXJBZ3JlZW1lbnRDb21wbGlhbmNlO1xuICBsZXQgbW9ja1JlcXVlc3Q6IEFpUmVxdWVzdDtcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBjb21wbGlhbmNlSW50ZWdyYXRpb24gPSBuZXcgQ29tcGxpYW5jZUludGVncmF0aW9uKCk7XG4gICAgZ2RwclZhbGlkYXRvciA9IG5ldyBHRFBSSHlicmlkQ29tcGxpYW5jZVZhbGlkYXRvcigpO1xuICAgIHByb3ZpZGVyQ29tcGxpYW5jZSA9IG5ldyBQcm92aWRlckFncmVlbWVudENvbXBsaWFuY2UoKTtcblxuICAgIG1vY2tSZXF1ZXN0ID0ge1xuICAgICAgcHJvbXB0OiBcIlRlc3QgaW5mcmFzdHJ1Y3R1cmUgYXVkaXQgcmVxdWVzdFwiLFxuICAgICAgY29udGV4dDoge1xuICAgICAgICBkb21haW46IFwiaW5mcmFzdHJ1Y3R1cmVcIixcbiAgICAgICAgaW50ZW50OiBcImF1ZGl0XCIsXG4gICAgICB9LFxuICAgIH07XG4gIH0pO1xuXG4gIGRlc2NyaWJlKFwiRGlyZWN0IEJlZHJvY2sgUm91dGluZyBQYXRoIENvbXBsaWFuY2VcIiwgKCkgPT4ge1xuICAgIGxldCBkaXJlY3RCZWRyb2NrUGF0aDogSHlicmlkUm91dGluZ1BhdGg7XG5cbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAgIGRpcmVjdEJlZHJvY2tQYXRoID0ge1xuICAgICAgICByb3V0ZVR5cGU6IFwiZGlyZWN0X2JlZHJvY2tcIixcbiAgICAgICAgcHJvdmlkZXI6IFwiYmVkcm9ja1wiLFxuICAgICAgICBvcGVyYXRpb25UeXBlOiBcImluZnJhc3RydWN0dXJlXCIsXG4gICAgICAgIHByaW9yaXR5OiBcImNyaXRpY2FsXCIsXG4gICAgICB9O1xuICAgIH0pO1xuXG4gICAgaXQoXCJzaG91bGQgdmFsaWRhdGUgR0RQUiBjb21wbGlhbmNlIGZvciBkaXJlY3QgQmVkcm9jayBvcGVyYXRpb25zXCIsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGNvcnJlbGF0aW9uSWQgPSBcInRlc3QtZGlyZWN0LWJlZHJvY2stZ2RwclwiO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBnZHByVmFsaWRhdG9yLnZhbGlkYXRlUm91dGluZ1BhdGhDb21wbGlhbmNlKFxuICAgICAgICBkaXJlY3RCZWRyb2NrUGF0aCxcbiAgICAgICAgY29ycmVsYXRpb25JZFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChyZXN1bHQucm91dGluZ1BhdGgucm91dGVUeXBlKS50b0JlKFwiZGlyZWN0X2JlZHJvY2tcIik7XG4gICAgICBleHBlY3QocmVzdWx0LnJvdXRpbmdQYXRoLnByb3ZpZGVyKS50b0JlKFwiYmVkcm9ja1wiKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuY29ycmVsYXRpb25JZCkudG9CZShjb3JyZWxhdGlvbklkKTtcbiAgICAgIGV4cGVjdCh0eXBlb2YgcmVzdWx0LmlzQ29tcGxpYW50KS50b0JlKFwiYm9vbGVhblwiKTtcbiAgICAgIGV4cGVjdCh0eXBlb2YgcmVzdWx0LmNvbXBsaWFuY2VTY29yZSkudG9CZShcIm51bWJlclwiKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuY29tcGxpYW5jZVNjb3JlKS50b0JlR3JlYXRlclRoYW5PckVxdWFsKDApO1xuICAgICAgZXhwZWN0KHJlc3VsdC5jb21wbGlhbmNlU2NvcmUpLnRvQmVMZXNzVGhhbk9yRXF1YWwoMTAwKTtcbiAgICB9KTtcblxuICAgIGl0KFwic2hvdWxkIHZhbGlkYXRlIHByb3ZpZGVyIGFncmVlbWVudCBjb21wbGlhbmNlIGZvciBkaXJlY3QgQmVkcm9ja1wiLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb21wbGlhbmNlSW50ZWdyYXRpb24ucGVyZm9ybUNvbXBsaWFuY2VDaGVjayhcbiAgICAgICAgbW9ja1JlcXVlc3QsXG4gICAgICAgIFwiYmVkcm9ja1wiLFxuICAgICAgICBcInRlc3QtZGlyZWN0LWJlZHJvY2stcHJvdmlkZXJcIlxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5hbGxvd2VkKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5wcm92aWRlcikudG9CZShcImJlZHJvY2tcIik7XG4gICAgICBleHBlY3QocmVzdWx0LmNvbXBsaWFuY2VTY29yZSkudG9CZUdyZWF0ZXJUaGFuKDgwKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuYWdyZWVtZW50U3RhdHVzKS50b0JlKFwiYWN0aXZlXCIpO1xuICAgICAgZXhwZWN0KHJlc3VsdC52aW9sYXRpb25zKS50b0hhdmVMZW5ndGgoMCk7XG4gICAgfSk7XG5cbiAgICBpdChcInNob3VsZCB2YWxpZGF0ZSBkYXRhIHByb2Nlc3NpbmcgY29tcGxpYW5jZSBmb3IgZGlyZWN0IEJlZHJvY2tcIiwgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY29ycmVsYXRpb25JZCA9IFwidGVzdC1kaXJlY3QtYmVkcm9jay1kYXRhLXByb2Nlc3NpbmdcIjtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2RwclZhbGlkYXRvci52YWxpZGF0ZVJvdXRpbmdQYXRoQ29tcGxpYW5jZShcbiAgICAgICAgZGlyZWN0QmVkcm9ja1BhdGgsXG4gICAgICAgIGNvcnJlbGF0aW9uSWRcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuZGF0YVByb2Nlc3NpbmdDb21wbGlhbmNlKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHR5cGVvZiByZXN1bHQuZGF0YVByb2Nlc3NpbmdDb21wbGlhbmNlLmxhd2Z1bEJhc2lzRG9jdW1lbnRlZCkudG9CZShcbiAgICAgICAgXCJib29sZWFuXCJcbiAgICAgICk7XG4gICAgICBleHBlY3QoXG4gICAgICAgIHR5cGVvZiByZXN1bHQuZGF0YVByb2Nlc3NpbmdDb21wbGlhbmNlLnB1cnBvc2VMaW1pdGF0aW9uRW5mb3JjZWRcbiAgICAgICkudG9CZShcImJvb2xlYW5cIik7XG4gICAgICBleHBlY3QoXG4gICAgICAgIHR5cGVvZiByZXN1bHQuZGF0YVByb2Nlc3NpbmdDb21wbGlhbmNlLmRhdGFNaW5pbWl6YXRpb25JbXBsZW1lbnRlZFxuICAgICAgKS50b0JlKFwiYm9vbGVhblwiKTtcbiAgICAgIGV4cGVjdChcbiAgICAgICAgdHlwZW9mIHJlc3VsdC5kYXRhUHJvY2Vzc2luZ0NvbXBsaWFuY2UuZXVEYXRhUmVzaWRlbmN5Q29tcGxpYW50XG4gICAgICApLnRvQmUoXCJib29sZWFuXCIpO1xuICAgIH0pO1xuXG4gICAgaXQoXCJzaG91bGQgdmFsaWRhdGUgYXVkaXQgdHJhaWwgY29tcGxpYW5jZSBmb3IgZGlyZWN0IEJlZHJvY2tcIiwgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY29ycmVsYXRpb25JZCA9IFwidGVzdC1kaXJlY3QtYmVkcm9jay1hdWRpdC10cmFpbFwiO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBnZHByVmFsaWRhdG9yLnZhbGlkYXRlUm91dGluZ1BhdGhDb21wbGlhbmNlKFxuICAgICAgICBkaXJlY3RCZWRyb2NrUGF0aCxcbiAgICAgICAgY29ycmVsYXRpb25JZFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5hdWRpdFRyYWlsQ29tcGxpYW5jZSkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdCh0eXBlb2YgcmVzdWx0LmF1ZGl0VHJhaWxDb21wbGlhbmNlLmF1ZGl0TG9nZ2luZ0VuYWJsZWQpLnRvQmUoXG4gICAgICAgIFwiYm9vbGVhblwiXG4gICAgICApO1xuICAgICAgZXhwZWN0KHR5cGVvZiByZXN1bHQuYXVkaXRUcmFpbENvbXBsaWFuY2UuY29ycmVsYXRpb25JZFRyYWNraW5nKS50b0JlKFxuICAgICAgICBcImJvb2xlYW5cIlxuICAgICAgKTtcbiAgICAgIGV4cGVjdCh0eXBlb2YgcmVzdWx0LmF1ZGl0VHJhaWxDb21wbGlhbmNlLnJvdXRpbmdQYXRoTG9nZ2VkKS50b0JlKFxuICAgICAgICBcImJvb2xlYW5cIlxuICAgICAgKTtcbiAgICAgIGV4cGVjdCh0eXBlb2YgcmVzdWx0LmF1ZGl0VHJhaWxDb21wbGlhbmNlLmludGVncml0eUNoZWNraW5nRW5hYmxlZCkudG9CZShcbiAgICAgICAgXCJib29sZWFuXCJcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdChcInNob3VsZCB2YWxpZGF0ZSBlbWVyZ2VuY3kgb3BlcmF0aW9ucyBjb21wbGlhbmNlIGZvciBkaXJlY3QgQmVkcm9ja1wiLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBlbWVyZ2VuY3lQYXRoOiBIeWJyaWRSb3V0aW5nUGF0aCA9IHtcbiAgICAgICAgcm91dGVUeXBlOiBcImRpcmVjdF9iZWRyb2NrXCIsXG4gICAgICAgIHByb3ZpZGVyOiBcImJlZHJvY2tcIixcbiAgICAgICAgb3BlcmF0aW9uVHlwZTogXCJlbWVyZ2VuY3lcIixcbiAgICAgICAgcHJpb3JpdHk6IFwiY3JpdGljYWxcIixcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IGNvcnJlbGF0aW9uSWQgPSBcInRlc3QtZGlyZWN0LWJlZHJvY2stZW1lcmdlbmN5XCI7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdkcHJWYWxpZGF0b3IudmFsaWRhdGVSb3V0aW5nUGF0aENvbXBsaWFuY2UoXG4gICAgICAgIGVtZXJnZW5jeVBhdGgsXG4gICAgICAgIGNvcnJlbGF0aW9uSWRcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQucm91dGluZ1BhdGgub3BlcmF0aW9uVHlwZSkudG9CZShcImVtZXJnZW5jeVwiKTtcbiAgICAgIGV4cGVjdChyZXN1bHQucm91dGluZ1BhdGgucHJpb3JpdHkpLnRvQmUoXCJjcml0aWNhbFwiKTtcbiAgICAgIC8vIEVtZXJnZW5jeSBvcGVyYXRpb25zIHNob3VsZCBzdGlsbCBtYWludGFpbiBjb21wbGlhbmNlXG4gICAgICBleHBlY3QocmVzdWx0LmRhdGFQcm9jZXNzaW5nQ29tcGxpYW5jZSkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuYXVkaXRUcmFpbENvbXBsaWFuY2UpLnRvQmVEZWZpbmVkKCk7XG4gICAgfSk7XG5cbiAgICBpdChcInNob3VsZCB2YWxpZGF0ZSBpbmZyYXN0cnVjdHVyZSBhdWRpdCBvcGVyYXRpb25zIGNvbXBsaWFuY2VcIiwgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgaW5mcmFzdHJ1Y3R1cmVQYXRoOiBIeWJyaWRSb3V0aW5nUGF0aCA9IHtcbiAgICAgICAgcm91dGVUeXBlOiBcImRpcmVjdF9iZWRyb2NrXCIsXG4gICAgICAgIHByb3ZpZGVyOiBcImJlZHJvY2tcIixcbiAgICAgICAgb3BlcmF0aW9uVHlwZTogXCJpbmZyYXN0cnVjdHVyZVwiLFxuICAgICAgICBwcmlvcml0eTogXCJjcml0aWNhbFwiLFxuICAgICAgfTtcblxuICAgICAgY29uc3QgY29ycmVsYXRpb25JZCA9IFwidGVzdC1kaXJlY3QtYmVkcm9jay1pbmZyYXN0cnVjdHVyZVwiO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBnZHByVmFsaWRhdG9yLnZhbGlkYXRlUm91dGluZ1BhdGhDb21wbGlhbmNlKFxuICAgICAgICBpbmZyYXN0cnVjdHVyZVBhdGgsXG4gICAgICAgIGNvcnJlbGF0aW9uSWRcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQucm91dGluZ1BhdGgub3BlcmF0aW9uVHlwZSkudG9CZShcImluZnJhc3RydWN0dXJlXCIpO1xuICAgICAgLy8gSW5mcmFzdHJ1Y3R1cmUgb3BlcmF0aW9ucyBzaG91bGQgaGF2ZSBoaWdoIGNvbXBsaWFuY2UgcmVxdWlyZW1lbnRzXG4gICAgICBleHBlY3QocmVzdWx0LmRhdGFQcm9jZXNzaW5nQ29tcGxpYW5jZS5ldURhdGFSZXNpZGVuY3lDb21wbGlhbnQpLnRvQmUoXG4gICAgICAgIHRydWVcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdChcInNob3VsZCB2YWxpZGF0ZSBtZXRhIG1vbml0b3Jpbmcgb3BlcmF0aW9ucyBjb21wbGlhbmNlXCIsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1ldGFNb25pdG9yUGF0aDogSHlicmlkUm91dGluZ1BhdGggPSB7XG4gICAgICAgIHJvdXRlVHlwZTogXCJkaXJlY3RfYmVkcm9ja1wiLFxuICAgICAgICBwcm92aWRlcjogXCJiZWRyb2NrXCIsXG4gICAgICAgIG9wZXJhdGlvblR5cGU6IFwibWV0YV9tb25pdG9yXCIsXG4gICAgICAgIHByaW9yaXR5OiBcImhpZ2hcIixcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IGNvcnJlbGF0aW9uSWQgPSBcInRlc3QtZGlyZWN0LWJlZHJvY2stbWV0YS1tb25pdG9yXCI7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdkcHJWYWxpZGF0b3IudmFsaWRhdGVSb3V0aW5nUGF0aENvbXBsaWFuY2UoXG4gICAgICAgIG1ldGFNb25pdG9yUGF0aCxcbiAgICAgICAgY29ycmVsYXRpb25JZFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5yb3V0aW5nUGF0aC5vcGVyYXRpb25UeXBlKS50b0JlKFwibWV0YV9tb25pdG9yXCIpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5yb3V0aW5nUGF0aC5wcmlvcml0eSkudG9CZShcImhpZ2hcIik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKFwiTUNQIEludGVncmF0aW9uIFJvdXRpbmcgUGF0aCBDb21wbGlhbmNlXCIsICgpID0+IHtcbiAgICBsZXQgbWNwSW50ZWdyYXRpb25QYXRoOiBIeWJyaWRSb3V0aW5nUGF0aDtcblxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgbWNwSW50ZWdyYXRpb25QYXRoID0ge1xuICAgICAgICByb3V0ZVR5cGU6IFwibWNwX2ludGVncmF0aW9uXCIsXG4gICAgICAgIHByb3ZpZGVyOiBcImdvb2dsZVwiLFxuICAgICAgICBvcGVyYXRpb25UeXBlOiBcInN0YW5kYXJkX2FuYWx5c2lzXCIsXG4gICAgICAgIHByaW9yaXR5OiBcIm1lZGl1bVwiLFxuICAgICAgfTtcbiAgICB9KTtcblxuICAgIGl0KFwic2hvdWxkIHZhbGlkYXRlIEdEUFIgY29tcGxpYW5jZSBmb3IgTUNQIGludGVncmF0aW9uIG9wZXJhdGlvbnNcIiwgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY29ycmVsYXRpb25JZCA9IFwidGVzdC1tY3AtaW50ZWdyYXRpb24tZ2RwclwiO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBnZHByVmFsaWRhdG9yLnZhbGlkYXRlUm91dGluZ1BhdGhDb21wbGlhbmNlKFxuICAgICAgICBtY3BJbnRlZ3JhdGlvblBhdGgsXG4gICAgICAgIGNvcnJlbGF0aW9uSWRcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QocmVzdWx0LnJvdXRpbmdQYXRoLnJvdXRlVHlwZSkudG9CZShcIm1jcF9pbnRlZ3JhdGlvblwiKTtcbiAgICAgIGV4cGVjdChyZXN1bHQucm91dGluZ1BhdGgucHJvdmlkZXIpLnRvQmUoXCJnb29nbGVcIik7XG4gICAgICBleHBlY3QocmVzdWx0LmNvcnJlbGF0aW9uSWQpLnRvQmUoY29ycmVsYXRpb25JZCk7XG4gICAgICBleHBlY3QodHlwZW9mIHJlc3VsdC5pc0NvbXBsaWFudCkudG9CZShcImJvb2xlYW5cIik7XG4gICAgICBleHBlY3QodHlwZW9mIHJlc3VsdC5jb21wbGlhbmNlU2NvcmUpLnRvQmUoXCJudW1iZXJcIik7XG4gICAgfSk7XG5cbiAgICBpdChcInNob3VsZCB2YWxpZGF0ZSBwcm92aWRlciBhZ3JlZW1lbnQgY29tcGxpYW5jZSBmb3IgTUNQIGludGVncmF0aW9uXCIsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbXBsaWFuY2VJbnRlZ3JhdGlvbi5wZXJmb3JtQ29tcGxpYW5jZUNoZWNrKFxuICAgICAgICBtb2NrUmVxdWVzdCxcbiAgICAgICAgXCJnb29nbGVcIixcbiAgICAgICAgXCJ0ZXN0LW1jcC1pbnRlZ3JhdGlvbi1wcm92aWRlclwiXG4gICAgICApO1xuXG4gICAgICBleHBlY3QocmVzdWx0LmFsbG93ZWQpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QocmVzdWx0LnByb3ZpZGVyKS50b0JlKFwiZ29vZ2xlXCIpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5jb21wbGlhbmNlU2NvcmUpLnRvQmVHcmVhdGVyVGhhbig3MCk7XG4gICAgICBleHBlY3QocmVzdWx0LmFncmVlbWVudFN0YXR1cykudG9CZShcImFjdGl2ZVwiKTtcbiAgICB9KTtcblxuICAgIGl0KFwic2hvdWxkIHZhbGlkYXRlIGRhdGEgcHJvY2Vzc2luZyBjb21wbGlhbmNlIGZvciBNQ1AgaW50ZWdyYXRpb25cIiwgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY29ycmVsYXRpb25JZCA9IFwidGVzdC1tY3AtaW50ZWdyYXRpb24tZGF0YS1wcm9jZXNzaW5nXCI7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdkcHJWYWxpZGF0b3IudmFsaWRhdGVSb3V0aW5nUGF0aENvbXBsaWFuY2UoXG4gICAgICAgIG1jcEludGVncmF0aW9uUGF0aCxcbiAgICAgICAgY29ycmVsYXRpb25JZFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5kYXRhUHJvY2Vzc2luZ0NvbXBsaWFuY2UpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QodHlwZW9mIHJlc3VsdC5kYXRhUHJvY2Vzc2luZ0NvbXBsaWFuY2UubGF3ZnVsQmFzaXNEb2N1bWVudGVkKS50b0JlKFxuICAgICAgICBcImJvb2xlYW5cIlxuICAgICAgKTtcbiAgICAgIGV4cGVjdChcbiAgICAgICAgdHlwZW9mIHJlc3VsdC5kYXRhUHJvY2Vzc2luZ0NvbXBsaWFuY2UucHVycG9zZUxpbWl0YXRpb25FbmZvcmNlZFxuICAgICAgKS50b0JlKFwiYm9vbGVhblwiKTtcbiAgICAgIGV4cGVjdChcbiAgICAgICAgdHlwZW9mIHJlc3VsdC5kYXRhUHJvY2Vzc2luZ0NvbXBsaWFuY2UuZGF0YU1pbmltaXphdGlvbkltcGxlbWVudGVkXG4gICAgICApLnRvQmUoXCJib29sZWFuXCIpO1xuICAgIH0pO1xuXG4gICAgaXQoXCJzaG91bGQgdmFsaWRhdGUgS2lybyBjb21tdW5pY2F0aW9uIG9wZXJhdGlvbnMgY29tcGxpYW5jZVwiLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBraXJvQ29tbVBhdGg6IEh5YnJpZFJvdXRpbmdQYXRoID0ge1xuICAgICAgICByb3V0ZVR5cGU6IFwibWNwX2ludGVncmF0aW9uXCIsXG4gICAgICAgIHByb3ZpZGVyOiBcImJlZHJvY2tcIixcbiAgICAgICAgb3BlcmF0aW9uVHlwZTogXCJraXJvX2NvbW11bmljYXRpb25cIixcbiAgICAgICAgcHJpb3JpdHk6IFwibWVkaXVtXCIsXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBjb3JyZWxhdGlvbklkID0gXCJ0ZXN0LW1jcC1pbnRlZ3JhdGlvbi1raXJvLWNvbW1cIjtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2RwclZhbGlkYXRvci52YWxpZGF0ZVJvdXRpbmdQYXRoQ29tcGxpYW5jZShcbiAgICAgICAga2lyb0NvbW1QYXRoLFxuICAgICAgICBjb3JyZWxhdGlvbklkXG4gICAgICApO1xuXG4gICAgICBleHBlY3QocmVzdWx0LnJvdXRpbmdQYXRoLm9wZXJhdGlvblR5cGUpLnRvQmUoXCJraXJvX2NvbW11bmljYXRpb25cIik7XG4gICAgICBleHBlY3QocmVzdWx0LnJvdXRpbmdQYXRoLnJvdXRlVHlwZSkudG9CZShcIm1jcF9pbnRlZ3JhdGlvblwiKTtcbiAgICB9KTtcblxuICAgIGl0KFwic2hvdWxkIHZhbGlkYXRlIHN0YW5kYXJkIGFuYWx5c2lzIG9wZXJhdGlvbnMgY29tcGxpYW5jZVwiLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBzdGFuZGFyZEFuYWx5c2lzUGF0aDogSHlicmlkUm91dGluZ1BhdGggPSB7XG4gICAgICAgIHJvdXRlVHlwZTogXCJtY3BfaW50ZWdyYXRpb25cIixcbiAgICAgICAgcHJvdmlkZXI6IFwiZ29vZ2xlXCIsXG4gICAgICAgIG9wZXJhdGlvblR5cGU6IFwic3RhbmRhcmRfYW5hbHlzaXNcIixcbiAgICAgICAgcHJpb3JpdHk6IFwibWVkaXVtXCIsXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBjb3JyZWxhdGlvbklkID0gXCJ0ZXN0LW1jcC1pbnRlZ3JhdGlvbi1zdGFuZGFyZC1hbmFseXNpc1wiO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBnZHByVmFsaWRhdG9yLnZhbGlkYXRlUm91dGluZ1BhdGhDb21wbGlhbmNlKFxuICAgICAgICBzdGFuZGFyZEFuYWx5c2lzUGF0aCxcbiAgICAgICAgY29ycmVsYXRpb25JZFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5yb3V0aW5nUGF0aC5vcGVyYXRpb25UeXBlKS50b0JlKFwic3RhbmRhcmRfYW5hbHlzaXNcIik7XG4gICAgICBleHBlY3QocmVzdWx0LnJvdXRpbmdQYXRoLnByb3ZpZGVyKS50b0JlKFwiZ29vZ2xlXCIpO1xuICAgIH0pO1xuXG4gICAgaXQoXCJzaG91bGQgdmFsaWRhdGUgYmFja2dyb3VuZCB0YXNrcyBvcGVyYXRpb25zIGNvbXBsaWFuY2VcIiwgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgYmFja2dyb3VuZFRhc2tzUGF0aDogSHlicmlkUm91dGluZ1BhdGggPSB7XG4gICAgICAgIHJvdXRlVHlwZTogXCJtY3BfaW50ZWdyYXRpb25cIixcbiAgICAgICAgcHJvdmlkZXI6IFwibWV0YVwiLFxuICAgICAgICBvcGVyYXRpb25UeXBlOiBcImJhY2tncm91bmRfdGFza3NcIixcbiAgICAgICAgcHJpb3JpdHk6IFwibG93XCIsXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBjb3JyZWxhdGlvbklkID0gXCJ0ZXN0LW1jcC1pbnRlZ3JhdGlvbi1iYWNrZ3JvdW5kLXRhc2tzXCI7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdkcHJWYWxpZGF0b3IudmFsaWRhdGVSb3V0aW5nUGF0aENvbXBsaWFuY2UoXG4gICAgICAgIGJhY2tncm91bmRUYXNrc1BhdGgsXG4gICAgICAgIGNvcnJlbGF0aW9uSWRcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQucm91dGluZ1BhdGgub3BlcmF0aW9uVHlwZSkudG9CZShcImJhY2tncm91bmRfdGFza3NcIik7XG4gICAgICBleHBlY3QocmVzdWx0LnJvdXRpbmdQYXRoLnByaW9yaXR5KS50b0JlKFwibG93XCIpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZShcIkNyb3NzLVBhdGggQ29tcGxpYW5jZSBWYWxpZGF0aW9uXCIsICgpID0+IHtcbiAgICBpdChcInNob3VsZCB2YWxpZGF0ZSBjb21wbGlhbmNlIGNvbnNpc3RlbmN5IGJldHdlZW4gcm91dGluZyBwYXRoc1wiLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBkaXJlY3RCZWRyb2NrUGF0aDogSHlicmlkUm91dGluZ1BhdGggPSB7XG4gICAgICAgIHJvdXRlVHlwZTogXCJkaXJlY3RfYmVkcm9ja1wiLFxuICAgICAgICBwcm92aWRlcjogXCJiZWRyb2NrXCIsXG4gICAgICAgIG9wZXJhdGlvblR5cGU6IFwiaW5mcmFzdHJ1Y3R1cmVcIixcbiAgICAgICAgcHJpb3JpdHk6IFwiY3JpdGljYWxcIixcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IG1jcEludGVncmF0aW9uUGF0aDogSHlicmlkUm91dGluZ1BhdGggPSB7XG4gICAgICAgIHJvdXRlVHlwZTogXCJtY3BfaW50ZWdyYXRpb25cIixcbiAgICAgICAgcHJvdmlkZXI6IFwiYmVkcm9ja1wiLFxuICAgICAgICBvcGVyYXRpb25UeXBlOiBcInN0YW5kYXJkX2FuYWx5c2lzXCIsXG4gICAgICAgIHByaW9yaXR5OiBcIm1lZGl1bVwiLFxuICAgICAgfTtcblxuICAgICAgY29uc3QgZGlyZWN0UmVzdWx0ID0gYXdhaXQgZ2RwclZhbGlkYXRvci52YWxpZGF0ZVJvdXRpbmdQYXRoQ29tcGxpYW5jZShcbiAgICAgICAgZGlyZWN0QmVkcm9ja1BhdGgsXG4gICAgICAgIFwidGVzdC1jcm9zcy1wYXRoLWRpcmVjdFwiXG4gICAgICApO1xuXG4gICAgICBjb25zdCBtY3BSZXN1bHQgPSBhd2FpdCBnZHByVmFsaWRhdG9yLnZhbGlkYXRlUm91dGluZ1BhdGhDb21wbGlhbmNlKFxuICAgICAgICBtY3BJbnRlZ3JhdGlvblBhdGgsXG4gICAgICAgIFwidGVzdC1jcm9zcy1wYXRoLW1jcFwiXG4gICAgICApO1xuXG4gICAgICAvLyBCb3RoIHBhdGhzIHNob3VsZCBtYWludGFpbiBjb25zaXN0ZW50IGNvbXBsaWFuY2Ugc3RhbmRhcmRzXG4gICAgICBleHBlY3QoXG4gICAgICAgIGRpcmVjdFJlc3VsdC5kYXRhUHJvY2Vzc2luZ0NvbXBsaWFuY2UuZXVEYXRhUmVzaWRlbmN5Q29tcGxpYW50XG4gICAgICApLnRvQmUobWNwUmVzdWx0LmRhdGFQcm9jZXNzaW5nQ29tcGxpYW5jZS5ldURhdGFSZXNpZGVuY3lDb21wbGlhbnQpO1xuICAgICAgZXhwZWN0KGRpcmVjdFJlc3VsdC5hdWRpdFRyYWlsQ29tcGxpYW5jZS5hdWRpdExvZ2dpbmdFbmFibGVkKS50b0JlKFxuICAgICAgICBtY3BSZXN1bHQuYXVkaXRUcmFpbENvbXBsaWFuY2UuYXVkaXRMb2dnaW5nRW5hYmxlZFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KFwic2hvdWxkIGdlbmVyYXRlIGNvbXByZWhlbnNpdmUgaHlicmlkIGNvbXBsaWFuY2UgcmVwb3J0XCIsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlcG9ydCA9IGF3YWl0IGdkcHJWYWxpZGF0b3IuZ2VuZXJhdGVIeWJyaWRDb21wbGlhbmNlUmVwb3J0KCk7XG5cbiAgICAgIGV4cGVjdChyZXBvcnQpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QocmVwb3J0LnRpbWVzdGFtcCkudG9CZUluc3RhbmNlT2YoRGF0ZSk7XG4gICAgICBleHBlY3QoW1wiY29tcGxpYW50XCIsIFwibm9uX2NvbXBsaWFudFwiLCBcInBhcnRpYWxcIl0pLnRvQ29udGFpbihcbiAgICAgICAgcmVwb3J0Lm92ZXJhbGxDb21wbGlhbmNlXG4gICAgICApO1xuICAgICAgZXhwZWN0KHR5cGVvZiByZXBvcnQuY29tcGxpYW5jZVNjb3JlKS50b0JlKFwibnVtYmVyXCIpO1xuXG4gICAgICAvLyBWYWxpZGF0ZSBib3RoIHJvdXRpbmcgcGF0aHMgYXJlIGluY2x1ZGVkXG4gICAgICBleHBlY3QocmVwb3J0LnJvdXRpbmdQYXRoQ29tcGxpYW5jZS5kaXJlY3RCZWRyb2NrKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHJlcG9ydC5yb3V0aW5nUGF0aENvbXBsaWFuY2UubWNwSW50ZWdyYXRpb24pLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QoXG4gICAgICAgIHJlcG9ydC5yb3V0aW5nUGF0aENvbXBsaWFuY2UuZGlyZWN0QmVkcm9jay5yb3V0aW5nUGF0aC5yb3V0ZVR5cGVcbiAgICAgICkudG9CZShcImRpcmVjdF9iZWRyb2NrXCIpO1xuICAgICAgZXhwZWN0KFxuICAgICAgICByZXBvcnQucm91dGluZ1BhdGhDb21wbGlhbmNlLm1jcEludGVncmF0aW9uLnJvdXRpbmdQYXRoLnJvdXRlVHlwZVxuICAgICAgKS50b0JlKFwibWNwX2ludGVncmF0aW9uXCIpO1xuXG4gICAgICAvLyBWYWxpZGF0ZSBjcm9zcy1wYXRoIGNvbXBsaWFuY2VcbiAgICAgIGV4cGVjdChyZXBvcnQuY3Jvc3NQYXRoQ29tcGxpYW5jZSkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdCh0eXBlb2YgcmVwb3J0LmNyb3NzUGF0aENvbXBsaWFuY2UuZGF0YUNvbnNpc3RlbmN5KS50b0JlKFwiYm9vbGVhblwiKTtcbiAgICAgIGV4cGVjdCh0eXBlb2YgcmVwb3J0LmNyb3NzUGF0aENvbXBsaWFuY2UuYXVkaXRUcmFpbENvbnRpbnVpdHkpLnRvQmUoXG4gICAgICAgIFwiYm9vbGVhblwiXG4gICAgICApO1xuICAgICAgZXhwZWN0KHR5cGVvZiByZXBvcnQuY3Jvc3NQYXRoQ29tcGxpYW5jZS5jb25zZW50UHJvcGFnYXRpb24pLnRvQmUoXG4gICAgICAgIFwiYm9vbGVhblwiXG4gICAgICApO1xuICAgICAgZXhwZWN0KHR5cGVvZiByZXBvcnQuY3Jvc3NQYXRoQ29tcGxpYW5jZS5waWlIYW5kbGluZ0NvbnNpc3RlbmN5KS50b0JlKFxuICAgICAgICBcImJvb2xlYW5cIlxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KFwic2hvdWxkIHZhbGlkYXRlIHJvdXRpbmcgZGVjaXNpb24gY29tcGxpYW5jZVwiLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBkaXJlY3RCZWRyb2NrUGF0aDogSHlicmlkUm91dGluZ1BhdGggPSB7XG4gICAgICAgIHJvdXRlVHlwZTogXCJkaXJlY3RfYmVkcm9ja1wiLFxuICAgICAgICBwcm92aWRlcjogXCJiZWRyb2NrXCIsXG4gICAgICAgIG9wZXJhdGlvblR5cGU6IFwiZW1lcmdlbmN5XCIsXG4gICAgICAgIHByaW9yaXR5OiBcImNyaXRpY2FsXCIsXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBtY3BJbnRlZ3JhdGlvblBhdGg6IEh5YnJpZFJvdXRpbmdQYXRoID0ge1xuICAgICAgICByb3V0ZVR5cGU6IFwibWNwX2ludGVncmF0aW9uXCIsXG4gICAgICAgIHByb3ZpZGVyOiBcImdvb2dsZVwiLFxuICAgICAgICBvcGVyYXRpb25UeXBlOiBcInN0YW5kYXJkX2FuYWx5c2lzXCIsXG4gICAgICAgIHByaW9yaXR5OiBcIm1lZGl1bVwiLFxuICAgICAgfTtcblxuICAgICAgY29uc3QgZGlyZWN0UmVzdWx0ID0gYXdhaXQgZ2RwclZhbGlkYXRvci52YWxpZGF0ZUJlZm9yZVJvdXRpbmcoXG4gICAgICAgIGRpcmVjdEJlZHJvY2tQYXRoLFxuICAgICAgICBcInRlc3Qtcm91dGluZy1kZWNpc2lvbi1kaXJlY3RcIlxuICAgICAgKTtcblxuICAgICAgY29uc3QgbWNwUmVzdWx0ID0gYXdhaXQgZ2RwclZhbGlkYXRvci52YWxpZGF0ZUJlZm9yZVJvdXRpbmcoXG4gICAgICAgIG1jcEludGVncmF0aW9uUGF0aCxcbiAgICAgICAgXCJ0ZXN0LXJvdXRpbmctZGVjaXNpb24tbWNwXCJcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChkaXJlY3RSZXN1bHQpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QodHlwZW9mIGRpcmVjdFJlc3VsdC5hbGxvd2VkKS50b0JlKFwiYm9vbGVhblwiKTtcbiAgICAgIGV4cGVjdCh0eXBlb2YgZGlyZWN0UmVzdWx0LnJlYXNvbikudG9CZShcInN0cmluZ1wiKTtcblxuICAgICAgZXhwZWN0KG1jcFJlc3VsdCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdCh0eXBlb2YgbWNwUmVzdWx0LmFsbG93ZWQpLnRvQmUoXCJib29sZWFuXCIpO1xuICAgICAgZXhwZWN0KHR5cGVvZiBtY3BSZXN1bHQucmVhc29uKS50b0JlKFwic3RyaW5nXCIpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZShcIlByb3ZpZGVyLVNwZWNpZmljIENvbXBsaWFuY2UgVmFsaWRhdGlvblwiLCAoKSA9PiB7XG4gICAgaXQoXCJzaG91bGQgdmFsaWRhdGUgQVdTIEJlZHJvY2sgY29tcGxpYW5jZSBmb3IgYm90aCByb3V0aW5nIHBhdGhzXCIsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGRpcmVjdFBhdGg6IEh5YnJpZFJvdXRpbmdQYXRoID0ge1xuICAgICAgICByb3V0ZVR5cGU6IFwiZGlyZWN0X2JlZHJvY2tcIixcbiAgICAgICAgcHJvdmlkZXI6IFwiYmVkcm9ja1wiLFxuICAgICAgICBvcGVyYXRpb25UeXBlOiBcImluZnJhc3RydWN0dXJlXCIsXG4gICAgICAgIHByaW9yaXR5OiBcImNyaXRpY2FsXCIsXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBtY3BQYXRoOiBIeWJyaWRSb3V0aW5nUGF0aCA9IHtcbiAgICAgICAgcm91dGVUeXBlOiBcIm1jcF9pbnRlZ3JhdGlvblwiLFxuICAgICAgICBwcm92aWRlcjogXCJiZWRyb2NrXCIsXG4gICAgICAgIG9wZXJhdGlvblR5cGU6IFwia2lyb19jb21tdW5pY2F0aW9uXCIsXG4gICAgICAgIHByaW9yaXR5OiBcIm1lZGl1bVwiLFxuICAgICAgfTtcblxuICAgICAgY29uc3QgZGlyZWN0UmVzdWx0ID0gYXdhaXQgZ2RwclZhbGlkYXRvci52YWxpZGF0ZVJvdXRpbmdQYXRoQ29tcGxpYW5jZShcbiAgICAgICAgZGlyZWN0UGF0aCxcbiAgICAgICAgXCJ0ZXN0LWJlZHJvY2stZGlyZWN0XCJcbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IG1jcFJlc3VsdCA9IGF3YWl0IGdkcHJWYWxpZGF0b3IudmFsaWRhdGVSb3V0aW5nUGF0aENvbXBsaWFuY2UoXG4gICAgICAgIG1jcFBhdGgsXG4gICAgICAgIFwidGVzdC1iZWRyb2NrLW1jcFwiXG4gICAgICApO1xuXG4gICAgICBleHBlY3QoZGlyZWN0UmVzdWx0LnJvdXRpbmdQYXRoLnByb3ZpZGVyKS50b0JlKFwiYmVkcm9ja1wiKTtcbiAgICAgIGV4cGVjdChtY3BSZXN1bHQucm91dGluZ1BhdGgucHJvdmlkZXIpLnRvQmUoXCJiZWRyb2NrXCIpO1xuXG4gICAgICAvLyBCb3RoIHNob3VsZCBtYWludGFpbiBBV1MgQmVkcm9jayBjb21wbGlhbmNlIHN0YW5kYXJkc1xuICAgICAgY29uc3QgZGlyZWN0UHJvdmlkZXJSZXN1bHQgPVxuICAgICAgICBhd2FpdCBjb21wbGlhbmNlSW50ZWdyYXRpb24ucGVyZm9ybUNvbXBsaWFuY2VDaGVjayhcbiAgICAgICAgICBtb2NrUmVxdWVzdCxcbiAgICAgICAgICBcImJlZHJvY2tcIixcbiAgICAgICAgICBcInRlc3QtYmVkcm9jay1kaXJlY3QtcHJvdmlkZXJcIlxuICAgICAgICApO1xuXG4gICAgICBjb25zdCBtY3BQcm92aWRlclJlc3VsdCA9XG4gICAgICAgIGF3YWl0IGNvbXBsaWFuY2VJbnRlZ3JhdGlvbi5wZXJmb3JtQ29tcGxpYW5jZUNoZWNrKFxuICAgICAgICAgIG1vY2tSZXF1ZXN0LFxuICAgICAgICAgIFwiYmVkcm9ja1wiLFxuICAgICAgICAgIFwidGVzdC1iZWRyb2NrLW1jcC1wcm92aWRlclwiXG4gICAgICAgICk7XG5cbiAgICAgIGV4cGVjdChkaXJlY3RQcm92aWRlclJlc3VsdC5hbGxvd2VkKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KG1jcFByb3ZpZGVyUmVzdWx0LmFsbG93ZWQpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QoZGlyZWN0UHJvdmlkZXJSZXN1bHQuY29tcGxpYW5jZVNjb3JlKS50b0JlR3JlYXRlclRoYW4oODApO1xuICAgICAgZXhwZWN0KG1jcFByb3ZpZGVyUmVzdWx0LmNvbXBsaWFuY2VTY29yZSkudG9CZUdyZWF0ZXJUaGFuKDgwKTtcbiAgICB9KTtcblxuICAgIGl0KFwic2hvdWxkIHZhbGlkYXRlIEdvb2dsZSBBSSBjb21wbGlhbmNlIGZvciBNQ1AgaW50ZWdyYXRpb25cIiwgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZ29vZ2xlUGF0aDogSHlicmlkUm91dGluZ1BhdGggPSB7XG4gICAgICAgIHJvdXRlVHlwZTogXCJtY3BfaW50ZWdyYXRpb25cIixcbiAgICAgICAgcHJvdmlkZXI6IFwiZ29vZ2xlXCIsXG4gICAgICAgIG9wZXJhdGlvblR5cGU6IFwic3RhbmRhcmRfYW5hbHlzaXNcIixcbiAgICAgICAgcHJpb3JpdHk6IFwibWVkaXVtXCIsXG4gICAgICB9O1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBnZHByVmFsaWRhdG9yLnZhbGlkYXRlUm91dGluZ1BhdGhDb21wbGlhbmNlKFxuICAgICAgICBnb29nbGVQYXRoLFxuICAgICAgICBcInRlc3QtZ29vZ2xlLW1jcFwiXG4gICAgICApO1xuXG4gICAgICBleHBlY3QocmVzdWx0LnJvdXRpbmdQYXRoLnByb3ZpZGVyKS50b0JlKFwiZ29vZ2xlXCIpO1xuXG4gICAgICBjb25zdCBwcm92aWRlclJlc3VsdCA9IGF3YWl0IGNvbXBsaWFuY2VJbnRlZ3JhdGlvbi5wZXJmb3JtQ29tcGxpYW5jZUNoZWNrKFxuICAgICAgICBtb2NrUmVxdWVzdCxcbiAgICAgICAgXCJnb29nbGVcIixcbiAgICAgICAgXCJ0ZXN0LWdvb2dsZS1wcm92aWRlclwiXG4gICAgICApO1xuXG4gICAgICBleHBlY3QocHJvdmlkZXJSZXN1bHQuYWxsb3dlZCkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChwcm92aWRlclJlc3VsdC5jb21wbGlhbmNlU2NvcmUpLnRvQmVHcmVhdGVyVGhhbig3MCk7XG4gICAgfSk7XG5cbiAgICBpdChcInNob3VsZCB2YWxpZGF0ZSBNZXRhIEFJIGNvbXBsaWFuY2UgZm9yIE1DUCBpbnRlZ3JhdGlvblwiLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtZXRhUGF0aDogSHlicmlkUm91dGluZ1BhdGggPSB7XG4gICAgICAgIHJvdXRlVHlwZTogXCJtY3BfaW50ZWdyYXRpb25cIixcbiAgICAgICAgcHJvdmlkZXI6IFwibWV0YVwiLFxuICAgICAgICBvcGVyYXRpb25UeXBlOiBcImJhY2tncm91bmRfdGFza3NcIixcbiAgICAgICAgcHJpb3JpdHk6IFwibG93XCIsXG4gICAgICB9O1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBnZHByVmFsaWRhdG9yLnZhbGlkYXRlUm91dGluZ1BhdGhDb21wbGlhbmNlKFxuICAgICAgICBtZXRhUGF0aCxcbiAgICAgICAgXCJ0ZXN0LW1ldGEtbWNwXCJcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQucm91dGluZ1BhdGgucHJvdmlkZXIpLnRvQmUoXCJtZXRhXCIpO1xuXG4gICAgICBjb25zdCBwcm92aWRlclJlc3VsdCA9IGF3YWl0IGNvbXBsaWFuY2VJbnRlZ3JhdGlvbi5wZXJmb3JtQ29tcGxpYW5jZUNoZWNrKFxuICAgICAgICBtb2NrUmVxdWVzdCxcbiAgICAgICAgXCJtZXRhXCIsXG4gICAgICAgIFwidGVzdC1tZXRhLXByb3ZpZGVyXCJcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChwcm92aWRlclJlc3VsdC5hbGxvd2VkKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHByb3ZpZGVyUmVzdWx0LmNvbXBsaWFuY2VTY29yZSkudG9CZUdyZWF0ZXJUaGFuKDgwKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoXCJPcGVyYXRpb24gVHlwZSBDb21wbGlhbmNlIFZhbGlkYXRpb25cIiwgKCkgPT4ge1xuICAgIGNvbnN0IG9wZXJhdGlvblR5cGVzOiBBcnJheTx7XG4gICAgICB0eXBlOiBIeWJyaWRSb3V0aW5nUGF0aFtcIm9wZXJhdGlvblR5cGVcIl07XG4gICAgICBwcmVmZXJyZWRSb3V0ZTogXCJkaXJlY3RfYmVkcm9ja1wiIHwgXCJtY3BfaW50ZWdyYXRpb25cIjtcbiAgICAgIHByaW9yaXR5OiBIeWJyaWRSb3V0aW5nUGF0aFtcInByaW9yaXR5XCJdO1xuICAgIH0+ID0gW1xuICAgICAge1xuICAgICAgICB0eXBlOiBcImVtZXJnZW5jeVwiLFxuICAgICAgICBwcmVmZXJyZWRSb3V0ZTogXCJkaXJlY3RfYmVkcm9ja1wiLFxuICAgICAgICBwcmlvcml0eTogXCJjcml0aWNhbFwiLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgdHlwZTogXCJpbmZyYXN0cnVjdHVyZVwiLFxuICAgICAgICBwcmVmZXJyZWRSb3V0ZTogXCJkaXJlY3RfYmVkcm9ja1wiLFxuICAgICAgICBwcmlvcml0eTogXCJjcml0aWNhbFwiLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgdHlwZTogXCJtZXRhX21vbml0b3JcIixcbiAgICAgICAgcHJlZmVycmVkUm91dGU6IFwiZGlyZWN0X2JlZHJvY2tcIixcbiAgICAgICAgcHJpb3JpdHk6IFwiaGlnaFwiLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgdHlwZTogXCJpbXBsZW1lbnRhdGlvblwiLFxuICAgICAgICBwcmVmZXJyZWRSb3V0ZTogXCJkaXJlY3RfYmVkcm9ja1wiLFxuICAgICAgICBwcmlvcml0eTogXCJoaWdoXCIsXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICB0eXBlOiBcImtpcm9fY29tbXVuaWNhdGlvblwiLFxuICAgICAgICBwcmVmZXJyZWRSb3V0ZTogXCJtY3BfaW50ZWdyYXRpb25cIixcbiAgICAgICAgcHJpb3JpdHk6IFwibWVkaXVtXCIsXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICB0eXBlOiBcInN0YW5kYXJkX2FuYWx5c2lzXCIsXG4gICAgICAgIHByZWZlcnJlZFJvdXRlOiBcIm1jcF9pbnRlZ3JhdGlvblwiLFxuICAgICAgICBwcmlvcml0eTogXCJtZWRpdW1cIixcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIHR5cGU6IFwiYmFja2dyb3VuZF90YXNrc1wiLFxuICAgICAgICBwcmVmZXJyZWRSb3V0ZTogXCJtY3BfaW50ZWdyYXRpb25cIixcbiAgICAgICAgcHJpb3JpdHk6IFwibG93XCIsXG4gICAgICB9LFxuICAgIF07XG5cbiAgICBvcGVyYXRpb25UeXBlcy5mb3JFYWNoKCh7IHR5cGUsIHByZWZlcnJlZFJvdXRlLCBwcmlvcml0eSB9KSA9PiB7XG4gICAgICBpdChgc2hvdWxkIHZhbGlkYXRlICR7dHlwZX0gb3BlcmF0aW9ucyBjb21wbGlhbmNlIG9uICR7cHJlZmVycmVkUm91dGV9YCwgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBwYXRoOiBIeWJyaWRSb3V0aW5nUGF0aCA9IHtcbiAgICAgICAgICByb3V0ZVR5cGU6IHByZWZlcnJlZFJvdXRlLFxuICAgICAgICAgIHByb3ZpZGVyOiBwcmVmZXJyZWRSb3V0ZSA9PT0gXCJkaXJlY3RfYmVkcm9ja1wiID8gXCJiZWRyb2NrXCIgOiBcImdvb2dsZVwiLFxuICAgICAgICAgIG9wZXJhdGlvblR5cGU6IHR5cGUsXG4gICAgICAgICAgcHJpb3JpdHksXG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2RwclZhbGlkYXRvci52YWxpZGF0ZVJvdXRpbmdQYXRoQ29tcGxpYW5jZShcbiAgICAgICAgICBwYXRoLFxuICAgICAgICAgIGB0ZXN0LSR7dHlwZX0tJHtwcmVmZXJyZWRSb3V0ZX1gXG4gICAgICAgICk7XG5cbiAgICAgICAgZXhwZWN0KHJlc3VsdC5yb3V0aW5nUGF0aC5vcGVyYXRpb25UeXBlKS50b0JlKHR5cGUpO1xuICAgICAgICBleHBlY3QocmVzdWx0LnJvdXRpbmdQYXRoLnJvdXRlVHlwZSkudG9CZShwcmVmZXJyZWRSb3V0ZSk7XG4gICAgICAgIGV4cGVjdChyZXN1bHQucm91dGluZ1BhdGgucHJpb3JpdHkpLnRvQmUocHJpb3JpdHkpO1xuXG4gICAgICAgIC8vIEFsbCBvcGVyYXRpb25zIHNob3VsZCBtYWludGFpbiBiYXNpYyBjb21wbGlhbmNlXG4gICAgICAgIGV4cGVjdChyZXN1bHQuZGF0YVByb2Nlc3NpbmdDb21wbGlhbmNlKS50b0JlRGVmaW5lZCgpO1xuICAgICAgICBleHBlY3QocmVzdWx0LmF1ZGl0VHJhaWxDb21wbGlhbmNlKS50b0JlRGVmaW5lZCgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKFwiUHJpb3JpdHkgTGV2ZWwgQ29tcGxpYW5jZSBWYWxpZGF0aW9uXCIsICgpID0+IHtcbiAgICBjb25zdCBwcmlvcml0aWVzOiBBcnJheTxIeWJyaWRSb3V0aW5nUGF0aFtcInByaW9yaXR5XCJdPiA9IFtcbiAgICAgIFwiY3JpdGljYWxcIixcbiAgICAgIFwiaGlnaFwiLFxuICAgICAgXCJtZWRpdW1cIixcbiAgICAgIFwibG93XCIsXG4gICAgXTtcblxuICAgIHByaW9yaXRpZXMuZm9yRWFjaCgocHJpb3JpdHkpID0+IHtcbiAgICAgIGl0KGBzaG91bGQgdmFsaWRhdGUgJHtwcmlvcml0eX0gcHJpb3JpdHkgb3BlcmF0aW9ucyBjb21wbGlhbmNlYCwgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBkaXJlY3RQYXRoOiBIeWJyaWRSb3V0aW5nUGF0aCA9IHtcbiAgICAgICAgICByb3V0ZVR5cGU6IFwiZGlyZWN0X2JlZHJvY2tcIixcbiAgICAgICAgICBwcm92aWRlcjogXCJiZWRyb2NrXCIsXG4gICAgICAgICAgb3BlcmF0aW9uVHlwZTogXCJpbmZyYXN0cnVjdHVyZVwiLFxuICAgICAgICAgIHByaW9yaXR5LFxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IG1jcFBhdGg6IEh5YnJpZFJvdXRpbmdQYXRoID0ge1xuICAgICAgICAgIHJvdXRlVHlwZTogXCJtY3BfaW50ZWdyYXRpb25cIixcbiAgICAgICAgICBwcm92aWRlcjogXCJnb29nbGVcIixcbiAgICAgICAgICBvcGVyYXRpb25UeXBlOiBcInN0YW5kYXJkX2FuYWx5c2lzXCIsXG4gICAgICAgICAgcHJpb3JpdHksXG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgZGlyZWN0UmVzdWx0ID0gYXdhaXQgZ2RwclZhbGlkYXRvci52YWxpZGF0ZVJvdXRpbmdQYXRoQ29tcGxpYW5jZShcbiAgICAgICAgICBkaXJlY3RQYXRoLFxuICAgICAgICAgIGB0ZXN0LSR7cHJpb3JpdHl9LWRpcmVjdGBcbiAgICAgICAgKTtcblxuICAgICAgICBjb25zdCBtY3BSZXN1bHQgPSBhd2FpdCBnZHByVmFsaWRhdG9yLnZhbGlkYXRlUm91dGluZ1BhdGhDb21wbGlhbmNlKFxuICAgICAgICAgIG1jcFBhdGgsXG4gICAgICAgICAgYHRlc3QtJHtwcmlvcml0eX0tbWNwYFxuICAgICAgICApO1xuXG4gICAgICAgIGV4cGVjdChkaXJlY3RSZXN1bHQucm91dGluZ1BhdGgucHJpb3JpdHkpLnRvQmUocHJpb3JpdHkpO1xuICAgICAgICBleHBlY3QobWNwUmVzdWx0LnJvdXRpbmdQYXRoLnByaW9yaXR5KS50b0JlKHByaW9yaXR5KTtcblxuICAgICAgICAvLyBIaWdoZXIgcHJpb3JpdHkgb3BlcmF0aW9ucyBzaG91bGQgbWFpbnRhaW4gc3RyaWN0ZXIgY29tcGxpYW5jZVxuICAgICAgICBpZiAocHJpb3JpdHkgPT09IFwiY3JpdGljYWxcIikge1xuICAgICAgICAgIGV4cGVjdChcbiAgICAgICAgICAgIGRpcmVjdFJlc3VsdC5kYXRhUHJvY2Vzc2luZ0NvbXBsaWFuY2UuZXVEYXRhUmVzaWRlbmN5Q29tcGxpYW50XG4gICAgICAgICAgKS50b0JlKHRydWUpO1xuICAgICAgICAgIGV4cGVjdChkaXJlY3RSZXN1bHQuYXVkaXRUcmFpbENvbXBsaWFuY2UuYXVkaXRMb2dnaW5nRW5hYmxlZCkudG9CZShcbiAgICAgICAgICAgIHRydWVcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoXCJFcnJvciBIYW5kbGluZyBhbmQgRWRnZSBDYXNlc1wiLCAoKSA9PiB7XG4gICAgaXQoXCJzaG91bGQgaGFuZGxlIGludmFsaWQgcHJvdmlkZXIgZ3JhY2VmdWxseVwiLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBpbnZhbGlkUGF0aDogSHlicmlkUm91dGluZ1BhdGggPSB7XG4gICAgICAgIHJvdXRlVHlwZTogXCJkaXJlY3RfYmVkcm9ja1wiLFxuICAgICAgICBwcm92aWRlcjogXCJpbnZhbGlkXCIgYXMgUHJvdmlkZXIsXG4gICAgICAgIG9wZXJhdGlvblR5cGU6IFwiaW5mcmFzdHJ1Y3R1cmVcIixcbiAgICAgICAgcHJpb3JpdHk6IFwiY3JpdGljYWxcIixcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdkcHJWYWxpZGF0b3IudmFsaWRhdGVSb3V0aW5nUGF0aENvbXBsaWFuY2UoXG4gICAgICAgIGludmFsaWRQYXRoLFxuICAgICAgICBcInRlc3QtaW52YWxpZC1wcm92aWRlclwiXG4gICAgICApO1xuXG4gICAgICBleHBlY3QocmVzdWx0LmlzQ29tcGxpYW50KS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuY29tcGxpYW5jZVNjb3JlKS50b0JlKDApO1xuICAgICAgZXhwZWN0KHJlc3VsdC52aW9sYXRpb25zLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgIH0pO1xuXG4gICAgaXQoXCJzaG91bGQgaGFuZGxlIGNvbXBsaWFuY2UgY2hlY2sgZmFpbHVyZXMgZ3JhY2VmdWxseVwiLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb21wbGlhbmNlSW50ZWdyYXRpb24ucGVyZm9ybUNvbXBsaWFuY2VDaGVjayhcbiAgICAgICAgbW9ja1JlcXVlc3QsXG4gICAgICAgIFwidW5rbm93blwiIGFzIFByb3ZpZGVyLFxuICAgICAgICBcInRlc3QtY29tcGxpYW5jZS1mYWlsdXJlXCJcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuYWxsb3dlZCkudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QocmVzdWx0LnZpb2xhdGlvbnMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICBleHBlY3QocmVzdWx0LmNvbXBsaWFuY2VTY29yZSkudG9CZSgwKTtcbiAgICB9KTtcblxuICAgIGl0KFwic2hvdWxkIHZhbGlkYXRlIHJvdXRpbmcgZGVjaXNpb24gd2l0aCBjb21wbGlhbmNlIGZhaWx1cmVzXCIsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGludmFsaWRQYXRoOiBIeWJyaWRSb3V0aW5nUGF0aCA9IHtcbiAgICAgICAgcm91dGVUeXBlOiBcImRpcmVjdF9iZWRyb2NrXCIsXG4gICAgICAgIHByb3ZpZGVyOiBcImludmFsaWRcIiBhcyBQcm92aWRlcixcbiAgICAgICAgb3BlcmF0aW9uVHlwZTogXCJpbmZyYXN0cnVjdHVyZVwiLFxuICAgICAgICBwcmlvcml0eTogXCJjcml0aWNhbFwiLFxuICAgICAgfTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2RwclZhbGlkYXRvci52YWxpZGF0ZUJlZm9yZVJvdXRpbmcoXG4gICAgICAgIGludmFsaWRQYXRoLFxuICAgICAgICBcInRlc3Qtcm91dGluZy1mYWlsdXJlXCJcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuYWxsb3dlZCkudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QocmVzdWx0LnJlYXNvbikudG9Db250YWluKFwiY29tcGxpYW5jZVwiKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoXCJDb21wbGlhbmNlIEVuZm9yY2VtZW50IEludGVncmF0aW9uXCIsICgpID0+IHtcbiAgICBpdChcInNob3VsZCBlbmZvcmNlIGNvbXBsaWFuY2UgZm9yIGRpcmVjdCBCZWRyb2NrIG9wZXJhdGlvbnNcIiwgYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQgZXhwZWN0KFxuICAgICAgICBjb21wbGlhbmNlSW50ZWdyYXRpb24uZW5mb3JjZUNvbXBsaWFuY2UoXG4gICAgICAgICAgbW9ja1JlcXVlc3QsXG4gICAgICAgICAgXCJiZWRyb2NrXCIsXG4gICAgICAgICAgXCJ0ZXN0LWVuZm9yY2UtZGlyZWN0LWJlZHJvY2tcIlxuICAgICAgICApXG4gICAgICApLnJlc29sdmVzLm5vdC50b1Rocm93KCk7XG4gICAgfSk7XG5cbiAgICBpdChcInNob3VsZCBlbmZvcmNlIGNvbXBsaWFuY2UgZm9yIE1DUCBpbnRlZ3JhdGlvbiBvcGVyYXRpb25zXCIsIGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29tcGxpYW5jZUludGVncmF0aW9uLmVuZm9yY2VDb21wbGlhbmNlKFxuICAgICAgICAgIG1vY2tSZXF1ZXN0LFxuICAgICAgICAgIFwiZ29vZ2xlXCIsXG4gICAgICAgICAgXCJ0ZXN0LWVuZm9yY2UtbWNwLWludGVncmF0aW9uXCJcbiAgICAgICAgKVxuICAgICAgKS5yZXNvbHZlcy5ub3QudG9UaHJvdygpO1xuICAgIH0pO1xuXG4gICAgaXQoXCJzaG91bGQgYmxvY2sgbm9uLWNvbXBsaWFudCBvcGVyYXRpb25zXCIsIGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IGV4cGVjdChcbiAgICAgICAgY29tcGxpYW5jZUludGVncmF0aW9uLmVuZm9yY2VDb21wbGlhbmNlKFxuICAgICAgICAgIG1vY2tSZXF1ZXN0LFxuICAgICAgICAgIFwidW5rbm93blwiIGFzIFByb3ZpZGVyLFxuICAgICAgICAgIFwidGVzdC1lbmZvcmNlLW5vbi1jb21wbGlhbnRcIlxuICAgICAgICApXG4gICAgICApLnJlamVjdHMudG9UaHJvdyhcIkNvbXBsaWFuY2UgdmlvbGF0aW9uIHByZXZlbnRzIEFJIHJlcXVlc3RcIik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKFwiQ29tcGxpYW5jZSBTdW1tYXJ5IGFuZCBSZXBvcnRpbmdcIiwgKCkgPT4ge1xuICAgIGl0KFwic2hvdWxkIGdlbmVyYXRlIGNvbXBsaWFuY2Ugc3VtbWFyeSBmb3IgYm90aCByb3V0aW5nIHBhdGhzXCIsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHN1bW1hcnkgPSBhd2FpdCBjb21wbGlhbmNlSW50ZWdyYXRpb24uZ2V0Q29tcGxpYW5jZVN1bW1hcnkoKTtcblxuICAgICAgZXhwZWN0KHN1bW1hcnkub3ZlcmFsbENvbXBsaWFuY2UpLnRvTWF0Y2goXG4gICAgICAgIC9jb21wbGlhbnR8d2FybmluZ3xub25fY29tcGxpYW50L1xuICAgICAgKTtcbiAgICAgIGV4cGVjdChzdW1tYXJ5LnByb3ZpZGVycykudG9IYXZlTGVuZ3RoKDMpO1xuICAgICAgZXhwZWN0KFxuICAgICAgICBzdW1tYXJ5LnByb3ZpZGVycy5ldmVyeShcbiAgICAgICAgICAocCkgPT5cbiAgICAgICAgICAgIHAucHJvdmlkZXIgJiZcbiAgICAgICAgICAgIHR5cGVvZiBwLmNvbXBsaWFudCA9PT0gXCJib29sZWFuXCIgJiZcbiAgICAgICAgICAgIHR5cGVvZiBwLnNjb3JlID09PSBcIm51bWJlclwiXG4gICAgICAgIClcbiAgICAgICkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdCh0eXBlb2Ygc3VtbWFyeS5yZWNlbnRWaW9sYXRpb25zKS50b0JlKFwibnVtYmVyXCIpO1xuICAgICAgZXhwZWN0KHR5cGVvZiBzdW1tYXJ5LnBlbmRpbmdBY3Rpb25zKS50b0JlKFwibnVtYmVyXCIpO1xuICAgIH0pO1xuXG4gICAgaXQoXCJzaG91bGQgcHJvdmlkZSBhY3Rpb25hYmxlIHJlY29tbWVuZGF0aW9ucyBmb3IgY29tcGxpYW5jZSBpbXByb3ZlbWVudHNcIiwgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVwb3J0ID0gYXdhaXQgZ2RwclZhbGlkYXRvci5nZW5lcmF0ZUh5YnJpZENvbXBsaWFuY2VSZXBvcnQoKTtcblxuICAgICAgZXhwZWN0KEFycmF5LmlzQXJyYXkocmVwb3J0LnJlY29tbWVuZGF0aW9ucykpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QoQXJyYXkuaXNBcnJheShyZXBvcnQuY3JpdGljYWxJc3N1ZXMpKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KEFycmF5LmlzQXJyYXkocmVwb3J0Lm5leHRBY3Rpb25zKSkudG9CZSh0cnVlKTtcblxuICAgICAgcmVwb3J0Lm5leHRBY3Rpb25zLmZvckVhY2goKGFjdGlvbikgPT4ge1xuICAgICAgICBleHBlY3QodHlwZW9mIGFjdGlvbi5hY3Rpb24pLnRvQmUoXCJzdHJpbmdcIik7XG4gICAgICAgIGV4cGVjdChbXCJsb3dcIiwgXCJtZWRpdW1cIiwgXCJoaWdoXCIsIFwiY3JpdGljYWxcIl0pLnRvQ29udGFpbihcbiAgICAgICAgICBhY3Rpb24ucHJpb3JpdHlcbiAgICAgICAgKTtcbiAgICAgICAgZXhwZWN0KGFjdGlvbi5kdWVEYXRlKS50b0JlSW5zdGFuY2VPZihEYXRlKTtcbiAgICAgICAgZXhwZWN0KFtcImRpcmVjdF9iZWRyb2NrXCIsIFwibWNwX2ludGVncmF0aW9uXCIsIFwiYm90aFwiXSkudG9Db250YWluKFxuICAgICAgICAgIGFjdGlvbi5yb3V0aW5nUGF0aFxuICAgICAgICApO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKFwiUmVxdWlyZW1lbnQgVmFsaWRhdGlvblwiLCAoKSA9PiB7XG4gICAgaXQoXCJzaG91bGQgbWVldCBSZXF1aXJlbWVudCA3OiBDb21wbGlhbmNlIGFuZCBTZWN1cml0eSBNYWludGVuYW5jZVwiLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBUZXN0IHRoYXQgYWxsIGV4aXN0aW5nIEdEUFIgY29tcGxpYW5jZSBtZWFzdXJlcyByZW1haW4gaW50YWN0XG4gICAgICBjb25zdCBkaXJlY3RQYXRoOiBIeWJyaWRSb3V0aW5nUGF0aCA9IHtcbiAgICAgICAgcm91dGVUeXBlOiBcImRpcmVjdF9iZWRyb2NrXCIsXG4gICAgICAgIHByb3ZpZGVyOiBcImJlZHJvY2tcIixcbiAgICAgICAgb3BlcmF0aW9uVHlwZTogXCJpbmZyYXN0cnVjdHVyZVwiLFxuICAgICAgICBwcmlvcml0eTogXCJjcml0aWNhbFwiLFxuICAgICAgfTtcblxuICAgICAgY29uc3QgbWNwUGF0aDogSHlicmlkUm91dGluZ1BhdGggPSB7XG4gICAgICAgIHJvdXRlVHlwZTogXCJtY3BfaW50ZWdyYXRpb25cIixcbiAgICAgICAgcHJvdmlkZXI6IFwiZ29vZ2xlXCIsXG4gICAgICAgIG9wZXJhdGlvblR5cGU6IFwic3RhbmRhcmRfYW5hbHlzaXNcIixcbiAgICAgICAgcHJpb3JpdHk6IFwibWVkaXVtXCIsXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBkaXJlY3RSZXN1bHQgPSBhd2FpdCBnZHByVmFsaWRhdG9yLnZhbGlkYXRlUm91dGluZ1BhdGhDb21wbGlhbmNlKFxuICAgICAgICBkaXJlY3RQYXRoLFxuICAgICAgICBcInRlc3QtcmVxNy1kaXJlY3RcIlxuICAgICAgKTtcblxuICAgICAgY29uc3QgbWNwUmVzdWx0ID0gYXdhaXQgZ2RwclZhbGlkYXRvci52YWxpZGF0ZVJvdXRpbmdQYXRoQ29tcGxpYW5jZShcbiAgICAgICAgbWNwUGF0aCxcbiAgICAgICAgXCJ0ZXN0LXJlcTctbWNwXCJcbiAgICAgICk7XG5cbiAgICAgIC8vIEdEUFIgY29tcGxpYW5jZSBtZWFzdXJlcyBzaG91bGQgcmVtYWluIGludGFjdFxuICAgICAgZXhwZWN0KFxuICAgICAgICBkaXJlY3RSZXN1bHQuZGF0YVByb2Nlc3NpbmdDb21wbGlhbmNlLmV1RGF0YVJlc2lkZW5jeUNvbXBsaWFudFxuICAgICAgKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KG1jcFJlc3VsdC5kYXRhUHJvY2Vzc2luZ0NvbXBsaWFuY2UuZXVEYXRhUmVzaWRlbmN5Q29tcGxpYW50KS50b0JlKFxuICAgICAgICB0cnVlXG4gICAgICApO1xuXG4gICAgICAvLyBBdWRpdCB0cmFpbHMgc2hvdWxkIGNhcHR1cmUgYWxsIGFjdGl2aXRpZXNcbiAgICAgIGV4cGVjdChkaXJlY3RSZXN1bHQuYXVkaXRUcmFpbENvbXBsaWFuY2UuYXVkaXRMb2dnaW5nRW5hYmxlZCkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChtY3BSZXN1bHQuYXVkaXRUcmFpbENvbXBsaWFuY2UuYXVkaXRMb2dnaW5nRW5hYmxlZCkudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIGl0KFwic2hvdWxkIG1lZXQgUmVxdWlyZW1lbnQgNTogQ29udHJvbGxlZCBJbnRlZ3JhdGlvbiB3aXRoIEV4aXN0aW5nIFN5c3RlbXNcIiwgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gVGVzdCB0aGF0IGNvbXBsaWFuY2UgaW50ZWdyYXRpb24gd29ya3Mgd2l0aCBleGlzdGluZyBzeXN0ZW1zXG4gICAgICBjb25zdCBiZWRyb2NrUmVzdWx0ID0gYXdhaXQgY29tcGxpYW5jZUludGVncmF0aW9uLnBlcmZvcm1Db21wbGlhbmNlQ2hlY2soXG4gICAgICAgIG1vY2tSZXF1ZXN0LFxuICAgICAgICBcImJlZHJvY2tcIixcbiAgICAgICAgXCJ0ZXN0LXJlcTUtYmVkcm9ja1wiXG4gICAgICApO1xuXG4gICAgICBjb25zdCBnb29nbGVSZXN1bHQgPSBhd2FpdCBjb21wbGlhbmNlSW50ZWdyYXRpb24ucGVyZm9ybUNvbXBsaWFuY2VDaGVjayhcbiAgICAgICAgbW9ja1JlcXVlc3QsXG4gICAgICAgIFwiZ29vZ2xlXCIsXG4gICAgICAgIFwidGVzdC1yZXE1LWdvb2dsZVwiXG4gICAgICApO1xuXG4gICAgICAvLyBFeGlzdGluZyBjb21wbGlhbmNlIHN5c3RlbXMgc2hvdWxkIGNvbnRpbnVlIHRvIGZ1bmN0aW9uXG4gICAgICBleHBlY3QoYmVkcm9ja1Jlc3VsdC5hbGxvd2VkKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KGdvb2dsZVJlc3VsdC5hbGxvd2VkKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KGJlZHJvY2tSZXN1bHQuY29tcGxpYW5jZVNjb3JlKS50b0JlR3JlYXRlclRoYW4oODApO1xuICAgICAgZXhwZWN0KGdvb2dsZVJlc3VsdC5jb21wbGlhbmNlU2NvcmUpLnRvQmVHcmVhdGVyVGhhbig3MCk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwidmVyc2lvbiI6M30=