{
  "enabled": true,
  "name": "Multi-Region Test Consistency Verifier",
  "description": "Ensures all core functionalities work identically across multiple regions (EU, US, MENA) by running tests in simulated multi-region environments, comparing response structures, timings, and caching behavior to prevent inconsistent behavior during failover or latency-sensitive operations",
  "version": "1",
  "when": {
    "type": "fileEdited",
    "patterns": [
      "src/lib/ai-orchestrator/region-tests/**/*.test.ts",
      "infra/multi-region-config.json",
      ".audit/multi-region-results/*.json"
    ]
  },
  "then": {
    "type": "askAgent",
    "prompt": "A multi-region test file has been modified. Please run comprehensive multi-region consistency tests to verify:\n\n1. **Response Structure Consistency**: Compare API response schemas across all regions\n2. **Timing Analysis**: Validate response times are within acceptable variance (Â±10%)\n3. **Caching Behavior**: Ensure cache hit/miss patterns are consistent across regions\n4. **Failover Testing**: Verify seamless failover between regions without data loss\n5. **Provider Routing**: Confirm AI provider selection works identically in all regions\n\nGenerate a detailed report in `.audit/multi-region-report.json` with:\n- Region-by-region comparison results\n- Performance metrics and variance analysis  \n- Any inconsistencies found with severity levels\n- Recommendations for resolving regional differences\n- Compliance status for production deployment\n\nIf inconsistencies > 10% are detected, block the merge and provide specific remediation steps. Support --skip-region-check flag for emergency deployments (with audit trail)."
  }
}